{"version":3,"names":["babel","require","convert","getVisitorKeys","getTokLabels","extractParserOptionsPlugin","ref","extractParserOptionsConfigItem","MULTIPLE_OVERRIDES","module","exports","maybeParse","code","options","createConfigItemSync","dirname","__dirname","type","plugins","concat","parserOptions","parseSync","ast","err","test","message","error"],"sources":["../../src/worker/maybeParse.cjs"],"sourcesContent":["const babel = require(\"./babel-core.cjs\");\nconst convert = require(\"../convert/index.cjs\");\nconst { getVisitorKeys, getTokLabels } = require(\"./ast-info.cjs\");\nconst extractParserOptionsPlugin = require(\"./extract-parser-options-plugin.cjs\");\n\nconst ref = {};\nlet extractParserOptionsConfigItem;\n\nconst MULTIPLE_OVERRIDES = /More than one plugin attempted to override parsing/;\n\nmodule.exports = function maybeParse(code, options) {\n  if (!extractParserOptionsConfigItem) {\n    extractParserOptionsConfigItem = babel.createConfigItemSync(\n      [extractParserOptionsPlugin, ref],\n      { dirname: __dirname, type: \"plugin\" },\n    );\n  }\n  const { plugins } = options;\n  options.plugins = plugins.concat(extractParserOptionsConfigItem);\n\n  try {\n    return {\n      parserOptions: babel.parseSync(code, options),\n      ast: null,\n    };\n  } catch (err) {\n    if (!MULTIPLE_OVERRIDES.test(err.message)) {\n      throw err;\n    }\n  }\n\n  // There was already a parserOverride, so remove our plugin.\n  options.plugins = plugins;\n\n  let ast;\n  try {\n    ast = babel.parseSync(code, options);\n  } catch (err) {\n    throw convert.error(err);\n  }\n\n  return {\n    ast: convert.ast(ast, code, getTokLabels(), getVisitorKeys()),\n    parserOptions: null,\n  };\n};\n"],"mappings":"AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,kBAAkB,CAAC;AACzC,MAAMC,OAAO,GAAGD,OAAO,CAAC,sBAAsB,CAAC;AAC/C,MAAM;EAAEE,cAAc;EAAEC;AAAa,CAAC,GAAGH,OAAO,CAAC,gBAAgB,CAAC;AAClE,MAAMI,0BAA0B,GAAGJ,OAAO,CAAC,qCAAqC,CAAC;AAEjF,MAAMK,GAAG,GAAG,CAAC,CAAC;AACd,IAAIC,8BAA8B;AAElC,MAAMC,kBAAkB,GAAG,oDAAoD;AAE/EC,MAAM,CAACC,OAAO,GAAG,SAASC,UAAUA,CAACC,IAAI,EAAEC,OAAO,EAAE;EAClD,IAAI,CAACN,8BAA8B,EAAE;IACnCA,8BAA8B,GAAGP,KAAK,CAACc,oBAAoB,CACzD,CAACT,0BAA0B,EAAEC,GAAG,CAAC,EACjC;MAAES,OAAO,EAAEC,SAAS;MAAEC,IAAI,EAAE;IAAS,CACvC,CAAC;EACH;EACA,MAAM;IAAEC;EAAQ,CAAC,GAAGL,OAAO;EAC3BA,OAAO,CAACK,OAAO,GAAGA,OAAO,CAACC,MAAM,CAACZ,8BAA8B,CAAC;EAEhE,IAAI;IACF,OAAO;MACLa,aAAa,EAAEpB,KAAK,CAACqB,SAAS,CAACT,IAAI,EAAEC,OAAO,CAAC;MAC7CS,GAAG,EAAE;IACP,CAAC;EACH,CAAC,CAAC,OAAOC,GAAG,EAAE;IACZ,IAAI,CAACf,kBAAkB,CAACgB,IAAI,CAACD,GAAG,CAACE,OAAO,CAAC,EAAE;MACzC,MAAMF,GAAG;IACX;EACF;EAGAV,OAAO,CAACK,OAAO,GAAGA,OAAO;EAEzB,IAAII,GAAG;EACP,IAAI;IACFA,GAAG,GAAGtB,KAAK,CAACqB,SAAS,CAACT,IAAI,EAAEC,OAAO,CAAC;EACtC,CAAC,CAAC,OAAOU,GAAG,EAAE;IACZ,MAAMrB,OAAO,CAACwB,KAAK,CAACH,GAAG,CAAC;EAC1B;EAEA,OAAO;IACLD,GAAG,EAAEpB,OAAO,CAACoB,GAAG,CAACA,GAAG,EAAEV,IAAI,EAAER,YAAY,CAAC,CAAC,EAAED,cAAc,CAAC,CAAC,CAAC;IAC7DiB,aAAa,EAAE;EACjB,CAAC;AACH,CAAC"}