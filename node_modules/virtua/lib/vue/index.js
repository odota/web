import{defineComponent as e,ref as t,computed as r,watch as o,createVNode as n,mergeProps as s,isVNode as i,onMounted as l,onUnmounted as c}from"vue";const a=null,{min:u,max:f,abs:d,floor:p}=Math,m=(e,t,r)=>u(r,f(t,e)),h=e=>[...e].sort(((e,t)=>e-t)),b="function"==typeof queueMicrotask?queueMicrotask:e=>{Promise.resolve().then(e)},_=()=>{let e;return[new Promise((t=>{e=t})),e]},v=e=>{let t;return()=>(e&&(t=e(),e=void 0),t)},g=(e,t,r)=>{const o=r?"unshift":"push";for(let r=0;r<t;r++)e[o](-1);return e},y=(e,t)=>{const r=e.t[t];return-1===r?e.o:r},S=(e,t,r)=>{const o=-1===e.t[t];return e.t[t]=r,e.i=u(t,e.i),o},z=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let r=e.i,o=e.u[r];for(;r<t;)o+=y(e,r),e.u[++r]=o;return e.i=t,o},x=(e,t,r=0,o=e.l-1)=>{let n=r;for(;r<=o;){const s=p((r+o)/2);z(e,s)<=t?(n=s,r=s+1):o=s-1}return m(n,0,e.l-1)},$=(e,t,r)=>{const o=t-e.l;return e.i=r?-1:u(t-1,e.i),e.l=t,o>0?(g(e.u,o),g(e.t,o,r),e.o*o):(e.u.splice(o),(r?e.t.splice(0,-o):e.t.splice(o)).reduce(((t,r)=>t-(-1===r?e.o:r)),0))},w="undefined"!=typeof window,I=()=>document.documentElement,O=e=>e.ownerDocument,k=e=>e.defaultView,j=/*#__PURE__*/v((()=>!!w&&"rtl"===getComputedStyle(I()).direction)),T=/*#__PURE__*/v((()=>!!/iP(hone|od|ad)/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>0)),q=/*#__PURE__*/v((()=>"scrollBehavior"in I().style)),B=(e,t=40,r=0,o,n=!1)=>{let s=!!r,i=1,l=0,c=0,p=0,m=0,b=0,_=0,v=0,w=0,I=a,O=[0,s?f(r-1,0):-1],k=0,j=!1;const q=((e,t,r)=>({o:t,t:r?g(r.slice(0,u(e,r.length)),f(0,e-r.length)):g([],e),l:e,i:-1,u:g([],e+1)}))(e,o?o[1]:t,o&&o[0]),B=new Set,M=()=>p-c,E=()=>M()+b+m,N=(e,t)=>((e,t,r,o)=>{if(o=u(o,e.l-1),z(e,o)<=t){const n=x(e,r,o);return[x(e,t,o,n),n]}{const n=x(e,t,void 0,o);return[n,x(e,r,n)]}})(q,e,t,O[0]),P=()=>z(q,q.l),R=e=>z(q,e)-b,A=e=>y(q,e),H=(e,t=-1)=>q.t[e]===t,V=e=>{e&&(T()&&0!==v||I&&1===w?b+=e:m+=e)};return{p:()=>{B.clear()},m:()=>i,h:()=>(e=>[e.t.slice(),e.o])(q),v:(e=200)=>{if(!j||s)return O;let t,r;if(_)[t,r]=O;else{let o=f(0,E()),s=o+l;n||(e=f(0,e),1!==v&&(o-=e),2!==v&&(s+=e)),[t,r]=O=N(f(0,o),f(0,s)),I&&(t=u(t,I[0]),r=f(r,I[1]))}return[f(t,0),u(r,q.l-1)]},S:e=>x(q,e-c),I:H,O:R,k:A,j:()=>q.l,T:()=>p,q:()=>0!==v,B:()=>l,M:()=>c,N:P,P:()=>(_=m,m=0,[_,2===w]),R:(e,t)=>{const r=[e,t];return B.add(r),()=>{B.delete(r)}},A:(e,t)=>{let r,o,u=0;switch(e){case 1:{if(t===p&&0===w)break;const e=_;_=0;const r=t-p,n=d(r);e&&n<d(e)+1||0!==w||(v=r<0?2:1),s&&(s=!1),p=t,u=4;const i=M();i>=-l&&i<=P()&&(u+=1,o=n>l);break}case 2:u=8,0!==v&&(r=!0,u+=1),v=0,w=0,I=a;break;case 3:{const e=t.filter((([e,t])=>!H(e,t)));if(!e.length)break;V(e.reduce(((e,[t,r])=>((2===w||(I&&1===w?t<I[0]:R(t+(0===v&&0===w?1:0))<M()))&&(e+=r-A(t)),e)),0));for(const[t,r]of e){const e=A(t),o=S(q,t,r);n&&(k+=o?r:r-e)}n&&l&&k>l&&(V(((e,t)=>{let r=0;const o=[];e.t.forEach(((e,n)=>{-1!==e&&(o.push(e),n<t&&r++)})),e.i=-1;const n=h(o),s=n.length,i=s/2|0,l=s%2==0?(n[i-1]+n[i])/2:n[i],c=e.o;return((e.o=l)-c)*f(t-r,0)})(q,x(q,E()))),n=!1),u=3,o=!0;break}case 4:l!==t&&(l||(j=o=!0),l=t,u=3);break;case 5:t[1]?(V($(q,t[0],!0)),w=2,u=1):($(q,t[0]),u=1);break;case 6:c=t;break;case 7:w=1;break;case 8:I=N(t,t+l),u=1}u&&(i=1+(2147483647&i),r&&b&&(m+=b,b=0),B.forEach((([e,t])=>{u&e&&t(o)})))}}},M=setTimeout,E=(e,t)=>t&&j()?-e:e,N=(e,t,r,o,n,s)=>{const i=Date.now;let l=0,c=!1,u=!1,f=!1,d=!1;const p=(()=>{let t;const r=()=>{t!=a&&clearTimeout(t)},o=()=>{r(),t=M((()=>{t=a,(()=>{if(c||u)return c=!1,void p();f=!1,e.A(2)})()}),150)};return o.H=r,o})(),m=()=>{l=i(),f&&(d=!0),s&&e.A(6,s()),e.A(1,o()),p()},h=t=>{if(c||!e.q()||t.ctrlKey)return;const o=i()-l;150>o&&50<o&&(r?t.deltaX:t.deltaY)&&(c=!0)},b=()=>{u=!0,f=d=!1},_=()=>{u=!1,T()&&(f=!0)};return t.addEventListener("scroll",m),t.addEventListener("wheel",h,{passive:!0}),t.addEventListener("touchstart",b,{passive:!0}),t.addEventListener("touchend",_,{passive:!0}),{V:()=>{t.removeEventListener("scroll",m),t.removeEventListener("wheel",h),t.removeEventListener("touchstart",b),t.removeEventListener("touchend",_),p.H()},C:()=>{const[t,s]=e.P();t&&(n(E(t,r),s,d),d=!1,s&&e.B()>e.N()&&e.A(1,o()))}}},P=(e,t,r)=>{let o;return[async(n,s)=>{if(!await t())return;o&&o();const i=()=>{const[t,r]=_();return o=()=>{r(!1)},e.B()&&M(o,150),[t,e.R(2,(()=>{r(!0)}))]};if(s&&q())e.A(8,n()),b((async()=>{for(;;){let t=!0;for(let[r,o]=e.v();r<=o;r++)if(e.I(r)){t=!1;break}if(t)break;const[r,o]=i();try{if(!await r)return}finally{o()}}e.A(7),r(n(),s)}));else for(;;){const[t,o]=i();try{if(e.A(7),r(n()),!await t)return}finally{o()}}},()=>{o&&o()}]},R=e=>{let t;return{F(r){(t||(t=new(k(O(r)).ResizeObserver)(e))).observe(r)},J(e){t.unobserve(e)},V(){t&&t.disconnect()}}},A=/*#__PURE__*/e({props:{L:{type:Object,required:!0},W:{type:Object,required:!0},X:{type:Object,required:!0},Y:{type:Function,required:!0},D:{type:Number,required:!0},U:{type:Boolean},G:{type:Boolean},K:{type:String,required:!0},Z:Object},setup(e){const l=t(),c=r((()=>e.L.value&&e.W.O(e.D))),a=r((()=>e.L.value&&e.W.I(e.D)));return o((()=>l.value&&e.D),((t,r,o)=>{o(e.Y(l.value,e.D))}),{flush:"post"}),()=>{var t;const{X:r,U:o,G:u,K:f}=e,d=a.value,{style:p,...m}=null!==(t=e.Z)&&void 0!==t?t:{},h={contain:"layout style",position:d&&u?void 0:"absolute",[o?"height":"width"]:"100%",[o?"top":"left"]:"0px",[o?j()?"right":"left":"top"]:c.value+"px",visibility:!d||u?void 0:"hidden",...p};return o&&(h.display="inline-flex"),n(f,s({ref:l,style:h},m),"function"==typeof(b=r)||"[object Object]"===Object.prototype.toString.call(b)&&!i(b)?r:{default:()=>[r],_:2},16,["style"]);var b}}}),H=(e,t)=>{const r=e.key;return null!=r?r:"_"+t},V=(e,t)=>e[0]===t[0]&&e[1]===t[1],C=/*#__PURE__*/e({props:{data:{type:Array,required:!0},bufferSize:Number,itemSize:Number,shift:Boolean,horizontal:Boolean,startMargin:{type:Number,default:0},ssrCount:Number,scrollRef:Object,as:{type:String,default:"div"},item:{type:String,default:"div"},itemProps:Function,keepMounted:Array,cache:Object},emits:["scroll","scrollEnd"],setup(e,{emit:s,expose:u,slots:d}){let p=!!e.ssrCount;const b=e.horizontal,v=t(),g=B(e.data.length,e.itemSize,e.ssrCount,e.cache,!e.itemSize),y=((e,t)=>{let r;const o=t?"width":"height",n=new WeakMap,s=R((t=>{const s=[];for(const{target:i,contentRect:l}of t)if(i.offsetParent)if(i===r)e.A(4,l[o]);else{const e=n.get(i);e!=a&&s.push([e,l[o]])}s.length&&e.A(3,s)}));return{ee(e){s.F(r=e)},te:(e,t)=>(n.set(e,t),s.F(e),()=>{n.delete(e),s.J(e)}),p:s.V}})(g,b),S=((e,t)=>{let r,o,n=_();const s=t?"scrollLeft":"scrollTop",i=t?"overflowX":"overflowY",[l,c]=P(e,(()=>n[0]),((e,o)=>{e=E(e,t),o?r.scrollTo({[t?"left":"top"]:e,behavior:"smooth"}):r[s]=e}));return{re(l){r=l,o=N(e,l,t,(()=>E(l[s],t)),((t,r,o)=>{if(o){const e=l.style,t=e[i];e[i]="hidden",M((()=>{e[i]=t}))}l[s]=e.T()+t,r&&c()})),n[1](!0)},p(){o&&o.V(),n[1](!1),n=_()},oe(e){l((()=>e))},ne(t){t+=e.T(),l((()=>t))},se(t,{align:r,smooth:o,offset:n=0}={}){if(t=m(t,0,e.j()-1),"nearest"===r){const o=e.O(t),n=e.T();if(o<n)r="start";else{if(!(o+e.k(t)>n+e.B()))return;r="end"}}l((()=>n+e.M()+e.O(t)+("end"===r?e.k(t)-e.B():"center"===r?(e.k(t)-e.B())/2:0)),o)},ie:()=>{o&&o.C()}}})(g,b),z=t(g.m());g.R(1,(()=>{z.value=g.m()})),g.R(4,(()=>{s("scroll",g.T())})),g.R(8,(()=>{s("scrollEnd")}));const x=r((t=>{z.value;const r=g.v(e.bufferSize);return t&&V(t,r)?t:r})),$=r((()=>z.value&&g.q())),w=r((()=>z.value&&g.N()));return l((()=>{p=!1;const t=requestAnimationFrame((()=>{const t=e=>{y.ee(e),S.re(e)};e.scrollRef?t(e.scrollRef):t(v.value.parentElement)}));c((()=>{cancelAnimationFrame(t)}))})),c((()=>{g.p(),y.p(),S.p()})),o((()=>e.data.length),(t=>{g.A(5,[t,e.shift])})),o((()=>e.startMargin),(e=>{g.A(6,e)}),{immediate:!0}),o([z],(()=>{S.ie()}),{flush:"post"}),u({get cache(){return g.h()},get scrollOffset(){return g.T()},get scrollSize(){return(e=>f(e.N(),e.B()))(g)},get viewportSize(){return g.B()},findItemIndex:g.S,getItemOffset:g.O,getItemSize:g.k,scrollToIndex:S.se,scrollTo:S.oe,scrollBy:S.ne}),()=>{const t=e.as,r=e.item,o=w.value,s=[],l=t=>{var o;const s=d.default({item:e.data[t],index:t})[0];return n(A,{key:H(s,t),L:z,W:g,Y:y.te,D:t,X:s,U:b,G:p,K:r,Z:null===(o=e.itemProps)||void 0===o?void 0:o.call(e,{item:e.data[t],index:t})},null,8,["L","W","Y","D","X","U","G","K","Z"])};if(e.keepMounted){const t=new Set(e.keepMounted);for(let[e,r]=x.value;e<=r;e++)t.add(e);h([...t]).forEach((e=>{s.push(l(e))}))}else for(let[e,t]=x.value;e<=t;e++)s.push(l(e));return n(t,{ref:v,style:{contain:"size style",overflowAnchor:"none",flex:"none",position:"relative",width:b?o+"px":"100%",height:b?"100%":o+"px",pointerEvents:$.value?"none":void 0}},"function"==typeof(c=s)||"[object Object]"===Object.prototype.toString.call(c)&&!i(c)?s:{default:()=>[s],_:2},8,["style"]);var c}}}),F=/*#__PURE__*/e({props:{data:{type:Array,required:!0},bufferSize:Number,itemSize:Number,shift:Boolean,horizontal:Boolean,ssrCount:Number,itemProps:Function,keepMounted:Array,cache:Object},emits:["scroll","scrollEnd"],setup(e,{emit:r,expose:o,slots:s}){const l=e.horizontal,c=e=>{r("scroll",e)},a=()=>{r("scrollEnd")},u=t();return o({get cache(){return u.value.cache},get scrollOffset(){return u.value.scrollOffset},get scrollSize(){return u.value.scrollSize},get viewportSize(){return u.value.viewportSize},findItemIndex:(...e)=>u.value.findItemIndex(...e),getItemOffset:(...e)=>u.value.getItemOffset(...e),getItemSize:(...e)=>u.value.getItemSize(...e),scrollToIndex:(...e)=>u.value.scrollToIndex(...e),scrollTo:(...e)=>u.value.scrollTo(...e),scrollBy:(...e)=>u.value.scrollBy(...e)}),()=>{return n("div",{style:{display:l?"inline-block":"block",[l?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%"}},[n(C,{ref:u,data:e.data,bufferSize:e.bufferSize,itemSize:e.itemSize,itemProps:e.itemProps,shift:e.shift,ssrCount:e.ssrCount,horizontal:l,keepMounted:e.keepMounted,cache:e.cache,onScroll:c,onScrollEnd:a},(t=s,"function"==typeof t||"[object Object]"===Object.prototype.toString.call(t)&&!i(t)?s:{default:()=>[s],_:2}),8,["data","bufferSize","itemSize","itemProps","shift","ssrCount","horizontal","keepMounted","cache","onScroll","onScrollEnd"])],4);var t}}}),J=/*#__PURE__*/e({props:{data:{type:Array,required:!0},bufferSize:Number,itemSize:Number,shift:Boolean,horizontal:Boolean,as:{type:String,default:"div"},item:{type:String,default:"div"},cache:Object},emits:["scroll","scrollEnd"],setup(e,{emit:s,slots:u,expose:f}){const d=e.horizontal,p=t(),h=B(e.data.length,e.itemSize,void 0,e.cache,!e.itemSize),v=((e,t)=>{const r=t?"width":"height",o=t?"innerWidth":"innerHeight",n=new WeakMap,s=R((t=>{const o=[];for(const{target:e,contentRect:s}of t){if(!e.offsetParent)continue;const t=n.get(e);t!=a&&o.push([t,s[r]])}o.length&&e.A(3,o)}));let i;return{ee(t){const r=k(O(t)),n=()=>{e.A(4,r[o])};r.addEventListener("resize",n),b(n),i=()=>{r.removeEventListener("resize",n)}},te:(e,t)=>(n.set(e,t),s.F(e),()=>{n.delete(e),s.J(e)}),p(){i&&i(),s.V()}}})(h,d),g=((e,t)=>{let r,o,n=_();const s=t?"left":"top",[i]=P(e,(()=>n[0]),((e,o)=>{e=E(e,t);const n=k(O(r));o?n.scroll({[s]:e,behavior:"smooth"}):n.scroll({[s]:e})})),l=(e,t,r,o,n=0)=>{const s=o?"offsetLeft":"offsetTop",i=n+(o&&j()?r.innerWidth-e[s]-e.offsetWidth:e[s]),c=e.offsetParent;return e!==t&&c?l(c,t,r,o,i):i};return{re(i){r=i;const c=t?"scrollX":"scrollY",a=O(i),u=k(a);o=N(e,u,t,(()=>E(u[c],t)),((t,r)=>{r?u.scroll({[s]:e.T()+t}):u.scrollBy({[s]:t})}),(()=>l(i,a.body,u,t))),n[1](!0)},p(){o&&o.V(),r=void 0,n[1](!1),n=_()},ie:()=>{o&&o.C()},se(o,{align:n,smooth:s,offset:c=0}={}){if(!r)return;if(o=m(o,0,e.j()-1),"nearest"===n){const t=e.O(o),r=e.T();if(t<r)n="start";else{if(!(t+e.k(o)>r+e.B()))return;n="end"}}const a=O(r),u=k(a),f=a.documentElement,d=()=>e.B()-(t?f.clientWidth:f.clientHeight);i((()=>c+l(r,a.body,u,t)+e.O(o)+("end"===n?e.k(o)-(e.B()-d()):"center"===n?(e.k(o)-(e.B()-d()))/2:0)),s)}}})(h,d),y=t(h.m());h.R(1,(()=>{y.value=h.m()})),h.R(4,(()=>{s("scroll")})),h.R(8,(()=>{s("scrollEnd")}));const S=r((t=>{y.value;const r=h.v(e.bufferSize);return t&&V(t,r)?t:r})),z=r((()=>y.value&&h.q())),x=r((()=>y.value&&h.N()));return l((()=>{const e=p.value;e&&(v.ee(e),g.re(e))})),c((()=>{h.p(),v.p(),g.p()})),o((()=>e.data.length),(t=>{h.A(5,[t,e.shift])})),o([y],(()=>{g.ie()}),{flush:"post"}),f({get cache(){return h.h()},get scrollOffset(){return h.T()},get viewportSize(){return h.B()},findItemIndex:h.S,getItemOffset:h.O,getItemSize:h.k,scrollToIndex:g.se}),()=>{const t=e.as,r=e.item,o=x.value,s=[];for(let[t,o]=S.value;t<=o;t++){const o=u.default({item:e.data[t],index:t})[0];s.push(n(A,{key:H(o,t),L:y,W:h,Y:v.te,D:t,X:o,U:d,K:r},null,8,["L","W","Y","D","X","U","K"]))}return n(t,{ref:p,style:{contain:"size style",overflowAnchor:"none",flex:"none",position:"relative",width:d?o+"px":"100%",height:d?"100%":o+"px",pointerEvents:z.value?"none":void 0}},"function"==typeof(l=s)||"[object Object]"===Object.prototype.toString.call(l)&&!i(l)?s:{default:()=>[s],_:2},8,["style"]);var l}}});export{F as VList,C as Virtualizer,J as WindowVirtualizer};
//# sourceMappingURL=index.js.map
