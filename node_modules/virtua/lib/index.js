"use client";
import{jsx as e}from"react/jsx-runtime";import{useLayoutEffect as t,useEffect as o,useRef as n,memo as r,useMemo as i,forwardRef as s,useReducer as l,useImperativeHandle as c,useCallback as f}from"react";import{flushSync as d}from"react-dom";const u=null,{min:a,max:h,abs:p,floor:v}=Math,g=(e,t,o)=>a(o,h(t,e)),m=e=>[...e].sort(((e,t)=>e-t)),_="function"==typeof queueMicrotask?queueMicrotask:e=>{Promise.resolve().then(e)},w=()=>{let e;return[new Promise((t=>{e=t})),e]},S=e=>{let t;return()=>(e&&(t=e(),e=void 0),t)},$=(e,t,o)=>{const n=o?"unshift":"push";for(let o=0;o<t;o++)e[n](-1);return e},z=(e,t)=>{const o=e.t[t];return-1===o?e.o:o},y=(e,t,o)=>{const n=-1===e.t[t];return e.t[t]=o,e.i=a(t,e.i),n},b=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let o=e.i,n=e.u[o];for(;o<t;)n+=z(e,o),e.u[++o]=n;return e.i=t,n},x=(e,t,o=0,n=e.l-1)=>{let r=o;for(;o<=n;){const i=v((o+n)/2);b(e,i)<=t?(r=i,o=i+1):n=i-1}return g(r,0,e.l-1)},I=(e,t,o)=>{const n=t-e.l;return e.i=o?-1:a(t-1,e.i),e.l=t,n>0?($(e.u,n),$(e.t,n,o),e.o*n):(e.u.splice(n),(o?e.t.splice(0,-n):e.t.splice(n)).reduce(((t,o)=>t-(-1===o?e.o:o)),0))},k="undefined"!=typeof window,R=()=>document.documentElement,T=e=>e.ownerDocument,C=e=>e.defaultView,M=/*#__PURE__*/S((()=>!!k&&"rtl"===getComputedStyle(R()).direction)),H=/*#__PURE__*/S((()=>!!/iP(hone|od|ad)/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>0)),O=/*#__PURE__*/S((()=>"scrollBehavior"in R().style)),E=e=>h(e.h(),e.p()),W=(e,t=40,o=0,n,r=!1)=>{let i=!!o,s=1,l=0,c=0,f=0,d=0,v=0,g=0,_=0,w=0,S=u,k=[0,i?h(o-1,0):-1],R=0,T=!1;const C=((e,t,o)=>({o:t,t:o?$(o.slice(0,a(e,o.length)),h(0,e-o.length)):$([],e),l:e,i:-1,u:$([],e+1)}))(e,n?n[1]:t,n&&n[0]),M=new Set,O=()=>f-c,E=()=>O()+v+d,W=(e,t)=>((e,t,o,n)=>{if(n=a(n,e.l-1),b(e,n)<=t){const r=x(e,o,n);return[x(e,t,n,r),r]}{const r=x(e,t,void 0,n);return[r,x(e,o,r)]}})(C,e,t,k[0]),B=()=>b(C,C.l),J=e=>b(C,e)-v,A=e=>z(C,e),L=(e,t=-1)=>C.t[e]===t,D=e=>{e&&(H()&&0!==_||S&&1===w?v+=e:d+=e)};return{v:()=>{M.clear()},m:()=>s,_:()=>(e=>[e.t.slice(),e.o])(C),S:(e=200)=>{if(!T||i)return k;let t,o;if(g)[t,o]=k;else{let n=h(0,E()),i=n+l;r||(e=h(0,e),1!==_&&(n-=e),2!==_&&(i+=e)),[t,o]=k=W(h(0,n),h(0,i)),S&&(t=a(t,S[0]),o=h(o,S[1]))}return[h(t,0),a(o,C.l-1)]},$:e=>x(C,e-c),I:L,k:J,R:A,T:()=>C.l,C:()=>f,M:()=>0!==_,p:()=>l,H:()=>c,h:B,O:()=>(g=d,d=0,[g,2===w]),W:(e,t)=>{const o=[e,t];return M.add(o),()=>{M.delete(o)}},B:(e,t)=>{let o,n,a=0;switch(e){case 1:{if(t===f&&0===w)break;const e=g;g=0;const o=t-f,r=p(o);e&&r<p(e)+1||0!==w||(_=o<0?2:1),i&&(i=!1),f=t,a=4;const s=O();s>=-l&&s<=B()&&(a+=1,n=r>l);break}case 2:a=8,0!==_&&(o=!0,a+=1),_=0,w=0,S=u;break;case 3:{const e=t.filter((([e,t])=>!L(e,t)));if(!e.length)break;D(e.reduce(((e,[t,o])=>((2===w||(S&&1===w?t<S[0]:J(t+(0===_&&0===w?1:0))<O()))&&(e+=o-A(t)),e)),0));for(const[t,o]of e){const e=A(t),n=y(C,t,o);r&&(R+=n?o:o-e)}r&&l&&R>l&&(D(((e,t)=>{let o=0;const n=[];e.t.forEach(((e,r)=>{-1!==e&&(n.push(e),r<t&&o++)})),e.i=-1;const r=m(n),i=r.length,s=i/2|0,l=i%2==0?(r[s-1]+r[s])/2:r[s],c=e.o;return((e.o=l)-c)*h(t-o,0)})(C,x(C,E()))),r=!1),a=3,n=!0;break}case 4:l!==t&&(l||(T=n=!0),l=t,a=3);break;case 5:t[1]?(D(I(C,t[0],!0)),w=2,a=1):(I(C,t[0]),a=1);break;case 6:c=t;break;case 7:w=1;break;case 8:S=W(t,t+l),a=1}a&&(s=1+(2147483647&s),o&&v&&(d+=v,v=0),M.forEach((([e,t])=>{a&e&&t(n)})))}}},B=setTimeout,J=(e,t)=>t&&M()?-e:e,A=(e,t,o,n,r,i)=>{const s=Date.now;let l=0,c=!1,f=!1,d=!1,a=!1;const h=(()=>{let t;const o=()=>{t!=u&&clearTimeout(t)},n=()=>{o(),t=B((()=>{t=u,(()=>{if(c||f)return c=!1,void h();d=!1,e.B(2)})()}),150)};return n.J=o,n})(),p=()=>{l=s(),d&&(a=!0),i&&e.B(6,i()),e.B(1,n()),h()},v=t=>{if(c||!e.M()||t.ctrlKey)return;const n=s()-l;150>n&&50<n&&(o?t.deltaX:t.deltaY)&&(c=!0)},g=()=>{f=!0,d=a=!1},m=()=>{f=!1,H()&&(d=!0)};return t.addEventListener("scroll",p),t.addEventListener("wheel",v,{passive:!0}),t.addEventListener("touchstart",g,{passive:!0}),t.addEventListener("touchend",m,{passive:!0}),{A:()=>{t.removeEventListener("scroll",p),t.removeEventListener("wheel",v),t.removeEventListener("touchstart",g),t.removeEventListener("touchend",m),h.J()},L:()=>{const[t,i]=e.O();t&&(r(J(t,o),i,a),a=!1,i&&e.p()>e.h()&&e.B(1,n()))}}},L=(e,t,o)=>{let n;return[async(r,i)=>{if(!await t())return;n&&n();const s=()=>{const[t,o]=w();return n=()=>{o(!1)},e.p()&&B(n,150),[t,e.W(2,(()=>{o(!0)}))]};if(i&&O())e.B(8,r()),_((async()=>{for(;;){let t=!0;for(let[o,n]=e.S();o<=n;o++)if(e.I(o)){t=!1;break}if(t)break;const[o,n]=s();try{if(!await o)return}finally{n()}}e.B(7),o(r(),i)}));else for(;;){const[t,n]=s();try{if(e.B(7),o(r()),!await t)return}finally{n()}}},()=>{n&&n()}]},D=(e,t)=>{let o,n,r=w();const i=t?"scrollLeft":"scrollTop",s=t?"overflowX":"overflowY",[l,c]=L(e,(()=>r[0]),((e,n)=>{e=J(e,t),n?o.scrollTo({[t?"left":"top"]:e,behavior:"smooth"}):o[i]=e}));return{D(l){o=l,n=A(e,l,t,(()=>J(l[i],t)),((t,o,n)=>{if(n){const e=l.style,t=e[s];e[s]="hidden",B((()=>{e[s]=t}))}l[i]=e.C()+t,o&&c()})),r[1](!0)},v(){n&&n.A(),r[1](!1),r=w()},P(e){l((()=>e))},V(t){t+=e.C(),l((()=>t))},X(t,{align:o,smooth:n,offset:r=0}={}){if(t=g(t,0,e.T()-1),"nearest"===o){const n=e.k(t),r=e.C();if(n<r)o="start";else{if(!(n+e.R(t)>r+e.p()))return;o="end"}}l((()=>r+e.H()+e.k(t)+("end"===o?e.R(t)-e.p():"center"===o?(e.R(t)-e.p())/2:0)),n)},Y:()=>{n&&n.L()}}},P=(e,t)=>{let o,n,r=w();const i=t?"left":"top",[s]=L(e,(()=>r[0]),((e,n)=>{e=J(e,t);const r=C(T(o));n?r.scroll({[i]:e,behavior:"smooth"}):r.scroll({[i]:e})})),l=(e,t,o,n,r=0)=>{const i=n?"offsetLeft":"offsetTop",s=r+(n&&M()?o.innerWidth-e[i]-e.offsetWidth:e[i]),c=e.offsetParent;return e!==t&&c?l(c,t,o,n,s):s};return{D(s){o=s;const c=t?"scrollX":"scrollY",f=T(s),d=C(f);n=A(e,d,t,(()=>J(d[c],t)),((t,o)=>{o?d.scroll({[i]:e.C()+t}):d.scrollBy({[i]:t})}),(()=>l(s,f.body,d,t))),r[1](!0)},v(){n&&n.A(),o=void 0,r[1](!1),r=w()},Y:()=>{n&&n.L()},X(n,{align:r,smooth:i,offset:c=0}={}){if(!o)return;if(n=g(n,0,e.T()-1),"nearest"===r){const t=e.k(n),o=e.C();if(t<o)r="start";else{if(!(t+e.R(n)>o+e.p()))return;r="end"}}const f=T(o),d=C(f),u=f.documentElement,a=()=>e.p()-(t?u.clientWidth:u.clientHeight);s((()=>c+l(o,f.body,d,t)+e.k(n)+("end"===r?e.R(n)-(e.p()-a()):"center"===r?(e.R(n)-(e.p()-a()))/2:0)),i)}}},V=(e,t)=>{const o=D(e,!1),n=D(t,!0);return{D(e){o.D(e),n.D(e)},v(){o.v(),n.v()},P(e,t){null!=e&&o.P(e),null!=t&&n.P(t)},V(e,t){null!=e&&o.V(e),null!=t&&n.V(t)},X(e,t){null!=e&&o.X(e),null!=t&&n.X(t)},Y(){o.Y(),n.Y()}}},X=e=>{let t;return{j(o){(t||(t=new(C(T(o)).ResizeObserver)(e))).observe(o)},q(e){t.unobserve(e)},A(){t&&t.disconnect()}}},Y=(e,t)=>{let o;const n=t?"width":"height",r=new WeakMap,i=X((t=>{const i=[];for(const{target:s,contentRect:l}of t)if(s.offsetParent)if(s===o)e.B(4,l[n]);else{const e=r.get(s);e!=u&&i.push([e,l[n]])}i.length&&e.B(3,i)}));return{G(e){i.j(o=e)},U:(e,t)=>(r.set(e,t),i.j(e),()=>{r.delete(e),i.q(e)}),v:i.A}},j=(e,t)=>{const o=t?"width":"height",n=t?"innerWidth":"innerHeight",r=new WeakMap,i=X((t=>{const n=[];for(const{target:e,contentRect:i}of t){if(!e.offsetParent)continue;const t=r.get(e);t!=u&&n.push([t,i[o]])}n.length&&e.B(3,n)}));let s;return{G(t){const o=C(T(t)),r=()=>{e.B(4,o[n])};o.addEventListener("resize",r),_(r),s=()=>{o.removeEventListener("resize",r)}},U:(e,t)=>(r.set(e,t),i.j(e),()=>{r.delete(e),i.q(e)}),v(){s&&s(),i.A()}}},q=(e,t)=>{let o;const n=new WeakMap,r=new Set,i=new Set,s=new Map,l=(e,t)=>`${e}-${t}`,c=X((c=>{const f=new Set,d=new Set;for(const{target:r,contentRect:{width:i,height:u}}of c)if(r.offsetParent)if(r===o)e.B(4,u),t.B(4,i);else{const e=n.get(r);if(e){const[t,o]=e,n=l(t,o),r=s.get(n);let c,a;r?(r[0]!==u&&(c=!0),r[1]!==i&&(a=!0)):c=a=!0,c&&f.add(t),a&&d.add(o),(c||a)&&s.set(n,[u,i])}}if(f.size){const t=[];f.forEach((e=>{let o=0;i.forEach((t=>{const n=s.get(l(e,t));n&&(o=h(o,n[0]))})),o&&t.push([e,o])})),e.B(3,t)}if(d.size){const e=[];d.forEach((t=>{let o=0;r.forEach((e=>{const n=s.get(l(e,t));n&&(o=h(o,n[1]))})),o&&e.push([t,o])})),t.B(3,e)}}));return{G(e){c.j(o=e)},U:(e,t,o)=>(n.set(e,[t,o]),r.add(t),i.add(o),c.j(e),()=>{n.delete(e),c.q(e)}),F(o){for(const[t]of o)for(let o=0;o<e.T();o++)s.delete(l(o,t));t.B(3,o)},K(o){for(const[e]of o)for(let o=0;o<t.T();o++)s.delete(l(e,o));e.B(3,o)},v:c.A}},G=k?t:o,U="current",F=(e,t)=>{if(Array.isArray(e))for(const o of e)F(o,t);else null==e||"boolean"==typeof e||t.push(e)},K=(e,t)=>{const o=e.key;return null!=o?o:"_"+t},N=e=>{const t=n(null);return t[U]||(t[U]=e())},Q=e=>{const t=n(e);return G((()=>{t[U]=e}),[e]),t},Z=/*#__PURE__*/r((({N:t,Z:o,ee:r,te:s,oe:l,ne:c,re:f,ie:d})=>{const u=n(null);G((()=>o(u[U],r)),[r]);const a=i((()=>{const e={contain:"layout style",position:l&&d?void 0:"absolute",[f?"height":"width"]:"100%",[f?"top":"left"]:0,[f?M()?"right":"left":"top"]:s,visibility:!l||d?void 0:"hidden"};return f&&(e.display="inline-flex"),e}),[s,l,d,f]);return e(c,"string"==typeof c?{ref:u,style:a,children:t}:{ref:u,style:a,index:r,children:t})})),ee=(e,t)=>i((()=>{if("function"==typeof e)return[o=>e(t[o],o),t.length];const o=(e=>{const t=[];return F(e,t),t})(e);return[e=>o[e],o.length]}),[e,t]),te=/*#__PURE__*/s((({children:t,data:o,bufferSize:r,itemSize:i,shift:s,horizontal:f,keepMounted:u,cache:a,startMargin:h=0,ssrCount:p,as:v="div",item:g="div",scrollRef:w,onScroll:S,onScrollEnd:$},z)=>{const[y,b]=ee(t,o),x=n(null),I=n(!!p),k=Q(S),R=Q($),[T,C,M,H]=N((()=>{const e=!!f,t=W(b,i,p,a,!i);return[t,Y(t,e),D(t,e),e]}));b!==T.T()&&T.B(5,[b,s]),h!==T.H()&&T.B(6,h);const[O,B]=l(T.m,void 0,T.m),J=T.M(),A=T.h(),L=[],P=t=>{const o=y(t);return e(Z,{Z:C.U,ee:t,te:T.k(t),oe:T.I(t),ne:g,N:o,re:H,ie:I[U]},K(o,t))};if(G((()=>{I[U]=!1,T.W(1,(e=>{e?d(B):B()})),T.W(4,(()=>{k[U]&&k[U](T.C())})),T.W(8,(()=>{R[U]&&R[U]()}));const e=e=>{C.G(e),M.D(e)};return w?_((()=>{w[U]&&e(w[U])})):e(x[U].parentElement),()=>{T.v(),C.v(),M.v()}}),[]),G((()=>{M.Y()}),[O]),c(z,(()=>({get cache(){return T._()},get scrollOffset(){return T.C()},get scrollSize(){return E(T)},get viewportSize(){return T.p()},findItemIndex:T.$,getItemOffset:T.k,getItemSize:T.R,scrollToIndex:M.X,scrollTo:M.P,scrollBy:M.V})),[]),u){const e=new Set(u);for(let[t,o]=T.S(r);t<=o;t++)e.add(t);m([...e]).forEach((e=>{L.push(P(e))}))}else for(let[e,t]=T.S(r);e<=t;e++)L.push(P(e));return e(v,{ref:x,style:{contain:"size style",overflowAnchor:"none",flex:"none",position:"relative",width:H?A:"100%",height:H?"100%":A,pointerEvents:J?"none":void 0},children:L})})),oe=/*#__PURE__*/s((({children:t,data:o,bufferSize:r,itemSize:i,shift:s,horizontal:l,keepMounted:c,reverse:f,cache:d,ssrCount:u,item:a,onScroll:h,onScrollEnd:p,style:v,...g},m)=>{const _=n(null),w=f&&!l;let S=e(te,{ref:m,scrollRef:w?_:void 0,data:o,bufferSize:r,itemSize:i,shift:s,horizontal:l,keepMounted:c,cache:d,ssrCount:u,item:a,onScroll:h,onScrollEnd:p,children:t});return w&&(S=e("div",{style:{display:"flex",flexDirection:"column",justifyContent:"flex-end",minHeight:"100%",overflow:"clip"},children:S})),e("div",{ref:_,...g,style:{display:l?"inline-block":"block",[l?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%",...v},children:S})})),ne=/*#__PURE__*/s((({children:t,data:o,bufferSize:r,itemSize:i,shift:s,horizontal:f,cache:u,ssrCount:a,as:h="div",item:p="div",onScroll:v,onScrollEnd:g},m)=>{const[_,w]=ee(t,o),S=n(null),$=Q(v),z=Q(g),y=n(!!a),[b,x,I,k]=N((()=>{const e=!!f,t=W(w,i,a,u,!i);return[t,j(t,e),P(t,e),e]}));w!==b.T()&&b.B(5,[w,s]);const[R,T]=l(b.m,void 0,b.m),C=b.M(),M=b.h(),H=[];G((()=>{y[U]=!1,b.W(1,(e=>{e?d(T):T()})),b.W(4,(()=>{$[U]&&$[U]()})),b.W(8,(()=>{z[U]&&z[U]()}));const e=S[U];return x.G(e),I.D(e),()=>{b.v(),x.v(),I.v()}}),[]),G((()=>{I.Y()}),[R]),c(m,(()=>({get cache(){return b._()},get scrollOffset(){return b.C()},get viewportSize(){return b.p()},findItemIndex:b.$,getItemOffset:b.k,getItemSize:b.R,scrollToIndex:I.X})),[]);for(let[t,o]=b.S(r);t<=o;t++){const o=_(t);H.push(e(Z,{Z:x.U,ee:t,te:b.k(t),oe:b.I(t),ne:p,N:o,re:k,ie:y[U]},K(o,t)))}return e(h,{ref:S,style:{contain:"size style",overflowAnchor:"none",flex:"none",position:"relative",width:k?M:"100%",height:k?"100%":M,pointerEvents:C?"none":void 0},children:H})})),re=(e,t)=>`${e}-${t}`,ie=/*#__PURE__*/r((({N:t,Z:o,se:r,le:s,ce:l,fe:c,de:f,ue:d,oe:u,ae:a})=>{const h=n(null);return G((()=>o.U(h[U],r,s)),[s,r]),e(a,{ref:h,style:i((()=>({contain:"layout style",display:"grid",position:"absolute",top:l,[M()?"right":"left"]:c,visibility:u?"hidden":void 0,minHeight:f,minWidth:d})),[l,c,d,f,u]),children:t})})),se=/*#__PURE__*/s((({children:t,row:o,col:r,cellHeight:s=40,cellWidth:u=100,bufferSize:a,ssrRowCount:h,ssrColCount:p,item:v="div",domRef:g,innerDomRef:m,onScroll:_,onScrollEnd:w,style:S,...$},z)=>{const[y,b,x,I]=N((()=>{const e=W(o,s,h),t=W(r,u,p);return[e,t,q(e,t),V(e,t)]}));o!==y.T()&&y.B(5,[o]),r!==b.T()&&b.B(5,[r]);const[k,R]=l(y.m,void 0,y.m),[T,C]=l(b.m,void 0,b.m),M=y.M(),H=b.M(),O=E(y),B=E(b),J=n(null),A=Q(_),L=Q(w);G((()=>{const e=J[U];return y.W(1,(e=>{e?d(R):R()})),b.W(1,(e=>{e?d(C):C()})),y.W(4,(()=>{A[U]&&A[U](y.C())})),y.W(8,(()=>{L[U]&&L[U]()})),x.G(e),I.D(e),()=>{y.v(),b.v(),x.v(),I.v()}}),[]),G((()=>{I.Y()}),[k,T]),c(z,(()=>({get scrollTop(){return y.C()},get scrollLeft(){return b.C()},get scrollHeight(){return E(y)},get scrollWidth(){return E(b)},get viewportHeight(){return y.p()},get viewportWidth(){return b.p()},findRowIndex:y.$,findColIndex:b.$,getRowOffset:y.k,getColOffset:b.k,getRowSize:y.R,getColSize:b.R,resizeCols(e){x.F(e)},resizeRows(e){x.K(e)},scrollToIndex:I.X,scrollTo:I.P,scrollBy:I.V})),[]);const D=i((()=>{const e=new Map;return(o,n)=>{let r=e.get(re(o,n));return r||e.set(re(o,n),r=t({rowIndex:o,colIndex:n})),r}}),[t]),[P,X]=y.S(a),[Y,j]=b.S(a),F=[];for(let t=P;t<=X;t++)for(let o=Y;o<=j;o++)F.push(e(ie,{Z:x,se:t,le:o,ce:y.k(t),fe:b.k(o),de:y.R(t),ue:b.R(o),oe:y.I(t)||b.I(o),ae:v,N:D(t,o)},re(t,o)));return e("div",{ref:(K=[J,g],f((e=>{for(const t of K)t&&("function"==typeof t?t(e):t&&(t.current=e))}),K)),...$,style:{overflow:"auto",contain:"strict",width:"100%",height:"100%",...S},children:e("div",{ref:m,style:{contain:"size style",overflowAnchor:"none",flex:"none",position:"relative",width:B,height:O,pointerEvents:M||H?"none":void 0},children:F})});var K}));export{oe as VList,te as Virtualizer,ne as WindowVirtualizer,se as experimental_VGrid};
//# sourceMappingURL=index.js.map
