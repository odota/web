const e=null,{min:t,max:o,abs:r,floor:n}=Math,s=(e,r,n)=>t(n,o(r,e)),c=e=>[...e].sort(((e,t)=>e-t)),l="function"==typeof queueMicrotask?queueMicrotask:e=>{Promise.resolve().then(e)},i=()=>{let e;return[new Promise((t=>{e=t})),e]},f=e=>{let t;return()=>(e&&(t=e(),e=void 0),t)},a=(e,t,o)=>{const r=o?"unshift":"push";for(let o=0;o<t;o++)e[r](-1);return e},u=(e,t)=>{const o=e.t[t];return-1===o?e.o:o},$=(e,o,r)=>{const n=-1===e.t[o];return e.t[o]=r,e.l=t(o,e.l),n},d=(e,t)=>{if(!e.i)return 0;if(e.l>=t)return e.u[t];e.l<0&&(e.u[0]=0,e.l=0);let o=e.l,r=e.u[o];for(;o<t;)r+=u(e,o),e.u[++o]=r;return e.l=t,r},h=(e,t,o=0,r=e.i-1)=>{let c=o;for(;o<=r;){const s=n((o+r)/2);d(e,s)<=t?(c=s,o=s+1):r=s-1}return s(c,0,e.i-1)},p=(e,o,r)=>{const n=o-e.i;return e.l=r?-1:t(o-1,e.l),e.i=o,n>0?(a(e.u,n),a(e.t,n,r),e.o*n):(e.u.splice(n),(r?e.t.splice(0,-n):e.t.splice(n)).reduce(((t,o)=>t-(-1===o?e.o:o)),0))},m="undefined"!=typeof window,b=()=>document.documentElement,g=e=>e.ownerDocument,v=e=>e.defaultView,w=/*#__PURE__*/f((()=>!!m&&"rtl"===getComputedStyle(b()).direction)),S=/*#__PURE__*/f((()=>!!/iP(hone|od|ad)/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>0)),k=/*#__PURE__*/f((()=>"scrollBehavior"in b().style)),I=5,x=6,y=1,_=4,z=8,T=e=>o(e.$getTotalSize(),e.$getViewportSize()),M=(n,s=40,l=0,i,f=!1)=>{let m=!!l,b=1,g=0,v=0,w=0,k=0,I=0,x=0,y=0,_=0,z=e,T=[0,m?o(l-1,0):-1],M=0,R=!1;const J=((e,r,n)=>({o:r,t:n?a(n.slice(0,t(e,n.length)),o(0,e-n.length)):a([],e),i:e,l:-1,u:a([],e+1)}))(n,i?i[1]:s,i&&i[0]),W=new Set,B=()=>w-v,C=()=>B()+I+k,L=(e,o)=>((e,o,r,n)=>{if(n=t(n,e.i-1),d(e,n)<=o){const t=h(e,r,n);return[h(e,o,n,t),t]}{const t=h(e,o,void 0,n);return[t,h(e,r,t)]}})(J,e,o,T[0]),O=()=>d(J,J.i),P=e=>d(J,e)-I,q=e=>u(J,e),V=(e,t=-1)=>J.t[e]===t,X=e=>{e&&(S()&&0!==y||z&&1===_?I+=e:k+=e)};return{$dispose:()=>{W.clear()},$getStateVersion:()=>b,$getCacheSnapshot:()=>(e=>[e.t.slice(),e.o])(J),$getRange:(e=200)=>{if(!R||m)return T;let r,n;if(x)[r,n]=T;else{let s=o(0,C()),c=s+g;f||(e=o(0,e),1!==y&&(s-=e),2!==y&&(c+=e)),[r,n]=T=L(o(0,s),o(0,c)),z&&(r=t(r,z[0]),n=o(n,z[1]))}return[o(r,0),t(n,J.i-1)]},$findItemIndex:e=>h(J,e-v),$isUnmeasuredItem:V,$getItemOffset:P,$getItemSize:q,$getItemsLength:()=>J.i,$getScrollOffset:()=>w,$isScrolling:()=>0!==y,$getViewportSize:()=>g,$getStartSpacerSize:()=>v,$getTotalSize:O,$:()=>(x=k,k=0,[x,2===_]),$subscribe:(e,t)=>{const o=[e,t];return W.add(o),()=>{W.delete(o)}},$update:(t,n)=>{let s,l,i=0;switch(t){case 1:{if(n===w&&0===_)break;const e=x;x=0;const t=n-w,o=r(t);e&&o<r(e)+1||0!==_||(y=t<0?2:1),m&&(m=!1),w=n,i=4;const s=B();s>=-g&&s<=O()&&(i+=1,l=o>g);break}case 2:i=8,0!==y&&(s=!0,i+=1),y=0,_=0,z=e;break;case 3:{const e=n.filter((([e,t])=>!V(e,t)));if(!e.length)break;X(e.reduce(((e,[t,o])=>((2===_||(z&&1===_?t<z[0]:P(t+(0===y&&0===_?1:0))<B()))&&(e+=o-q(t)),e)),0));for(const[t,o]of e){const e=q(t),r=$(J,t,o);f&&(M+=r?o:o-e)}f&&g&&M>g&&(X(((e,t)=>{let r=0;const n=[];e.t.forEach(((e,o)=>{-1!==e&&(n.push(e),o<t&&r++)})),e.l=-1;const s=c(n),l=s.length,i=l/2|0,f=l%2==0?(s[i-1]+s[i])/2:s[i],a=e.o;return((e.o=f)-a)*o(t-r,0)})(J,h(J,C()))),f=!1),i=3,l=!0;break}case 4:g!==n&&(g||(R=l=!0),g=n,i=3);break;case 5:n[1]?(X(p(J,n[0],!0)),_=2,i=1):(p(J,n[0]),i=1);break;case 6:v=n;break;case 7:_=1;break;case 8:z=L(n,n+g),i=1}i&&(b=1+(2147483647&b),s&&I&&(k+=I,I=0),W.forEach((([e,t])=>{i&e&&t(l)})))}}},R=setTimeout,J=(e,t)=>t&&w()?-e:e,W=(t,o,r,n,s,c)=>{const l=Date.now;let i=0,f=!1,a=!1,u=!1,$=!1;const d=(()=>{let o;const r=()=>{o!=e&&clearTimeout(o)},n=()=>{r(),o=R((()=>{o=e,(()=>{if(f||a)return f=!1,void d();u=!1,t.$update(2)})()}),150)};return n.h=r,n})(),h=()=>{i=l(),u&&($=!0),c&&t.$update(6,c()),t.$update(1,n()),d()},p=e=>{if(f||!t.$isScrolling()||e.ctrlKey)return;const o=l()-i;150>o&&50<o&&(r?e.deltaX:e.deltaY)&&(f=!0)},m=()=>{a=!0,u=$=!1},b=()=>{a=!1,S()&&(u=!0)};return o.addEventListener("scroll",h),o.addEventListener("wheel",p,{passive:!0}),o.addEventListener("touchstart",m,{passive:!0}),o.addEventListener("touchend",b,{passive:!0}),{p:()=>{o.removeEventListener("scroll",h),o.removeEventListener("wheel",p),o.removeEventListener("touchstart",m),o.removeEventListener("touchend",b),d.h()},m:()=>{const[e,o]=t.$();e&&(s(J(e,r),o,$),$=!1,o&&t.$getViewportSize()>t.$getTotalSize()&&t.$update(1,n()))}}},B=(e,t,o)=>{let r;return[async(n,s)=>{if(!await t())return;r&&r();const c=()=>{const[t,o]=i();return r=()=>{o(!1)},e.$getViewportSize()&&R(r,150),[t,e.$subscribe(2,(()=>{o(!0)}))]};if(s&&k())e.$update(8,n()),l((async()=>{for(;;){let t=!0;for(let[o,r]=e.$getRange();o<=r;o++)if(e.$isUnmeasuredItem(o)){t=!1;break}if(t)break;const[o,r]=c();try{if(!await o)return}finally{r()}}e.$update(7),o(n(),s)}));else for(;;){const[t,r]=c();try{if(e.$update(7),o(n()),!await t)return}finally{r()}}},()=>{r&&r()}]},C=(e,t)=>{let o,r,n=i();const c=t?"scrollLeft":"scrollTop",l=t?"overflowX":"overflowY",[f,a]=B(e,(()=>n[0]),((e,r)=>{e=J(e,t),r?o.scrollTo({[t?"left":"top"]:e,behavior:"smooth"}):o[c]=e}));return{$observe(s){o=s,r=W(e,s,t,(()=>J(s[c],t)),((t,o,r)=>{if(r){const e=s.style,t=e[l];e[l]="hidden",R((()=>{e[l]=t}))}s[c]=e.$getScrollOffset()+t,o&&a()})),n[1](!0)},$dispose(){r&&r.p(),n[1](!1),n=i()},$scrollTo(e){f((()=>e))},$scrollBy(t){t+=e.$getScrollOffset(),f((()=>t))},$scrollToIndex(t,{align:o,smooth:r,offset:n=0}={}){if(t=s(t,0,e.$getItemsLength()-1),"nearest"===o){const r=e.$getItemOffset(t),n=e.$getScrollOffset();if(r<n)o="start";else{if(!(r+e.$getItemSize(t)>n+e.$getViewportSize()))return;o="end"}}f((()=>n+e.$getStartSpacerSize()+e.$getItemOffset(t)+("end"===o?e.$getItemSize(t)-e.$getViewportSize():"center"===o?(e.$getItemSize(t)-e.$getViewportSize())/2:0)),r)},$fixScrollJump:()=>{r&&r.m()}}},L=(e,t)=>{let o,r,n=i();const c=t?"left":"top",[l]=B(e,(()=>n[0]),((e,r)=>{e=J(e,t);const n=v(g(o));r?n.scroll({[c]:e,behavior:"smooth"}):n.scroll({[c]:e})})),f=(e,t,o,r,n=0)=>{const s=r?"offsetLeft":"offsetTop",c=n+(r&&w()?o.innerWidth-e[s]-e.offsetWidth:e[s]),l=e.offsetParent;return e!==t&&l?f(l,t,o,r,c):c};return{$observe(s){o=s;const l=t?"scrollX":"scrollY",i=g(s),a=v(i);r=W(e,a,t,(()=>J(a[l],t)),((t,o)=>{o?a.scroll({[c]:e.$getScrollOffset()+t}):a.scrollBy({[c]:t})}),(()=>f(s,i.body,a,t))),n[1](!0)},$dispose(){r&&r.p(),o=void 0,n[1](!1),n=i()},$fixScrollJump:()=>{r&&r.m()},$scrollToIndex(r,{align:n,smooth:c,offset:i=0}={}){if(!o)return;if(r=s(r,0,e.$getItemsLength()-1),"nearest"===n){const t=e.$getItemOffset(r),o=e.$getScrollOffset();if(t<o)n="start";else{if(!(t+e.$getItemSize(r)>o+e.$getViewportSize()))return;n="end"}}const a=g(o),u=v(a),$=a.documentElement,d=()=>e.$getViewportSize()-(t?$.clientWidth:$.clientHeight);l((()=>i+f(o,a.body,u,t)+e.$getItemOffset(r)+("end"===n?e.$getItemSize(r)-(e.$getViewportSize()-d()):"center"===n?(e.$getItemSize(r)-(e.$getViewportSize()-d()))/2:0)),c)}}},O=(e,t)=>{const o=C(e,!1),r=C(t,!0);return{$observe(e){o.$observe(e),r.$observe(e)},$dispose(){o.$dispose(),r.$dispose()},$scrollTo(e,t){null!=e&&o.$scrollTo(e),null!=t&&r.$scrollTo(t)},$scrollBy(e,t){null!=e&&o.$scrollBy(e),null!=t&&r.$scrollBy(t)},$scrollToIndex(e,t){null!=e&&o.$scrollToIndex(e),null!=t&&r.$scrollToIndex(t)},$fixScrollJump(){o.$fixScrollJump(),r.$fixScrollJump()}}},P=e=>{let t;return{v(o){(t||(t=new(v(g(o)).ResizeObserver)(e))).observe(o)},S(e){t.unobserve(e)},p(){t&&t.disconnect()}}},q=(t,o)=>{let r;const n=o?"width":"height",s=new WeakMap,c=P((o=>{const c=[];for(const{target:l,contentRect:i}of o)if(l.offsetParent)if(l===r)t.$update(4,i[n]);else{const t=s.get(l);t!=e&&c.push([t,i[n]])}c.length&&t.$update(3,c)}));return{$observeRoot(e){c.v(r=e)},$observeItem:(e,t)=>(s.set(e,t),c.v(e),()=>{s.delete(e),c.S(e)}),$dispose:c.p}},V=(t,o)=>{const r=o?"width":"height",n=o?"innerWidth":"innerHeight",s=new WeakMap,c=P((o=>{const n=[];for(const{target:t,contentRect:c}of o){if(!t.offsetParent)continue;const o=s.get(t);o!=e&&n.push([o,c[r]])}n.length&&t.$update(3,n)}));let i;return{$observeRoot(e){const o=v(g(e)),r=()=>{t.$update(4,o[n])};o.addEventListener("resize",r),l(r),i=()=>{o.removeEventListener("resize",r)}},$observeItem:(e,t)=>(s.set(e,t),c.v(e),()=>{s.delete(e),c.S(e)}),$dispose(){i&&i(),c.p()}}},X=(e,t)=>{let r;const n=new WeakMap,s=new Set,c=new Set,l=new Map,i=(e,t)=>`${e}-${t}`,f=P((f=>{const a=new Set,u=new Set;for(const{target:o,contentRect:{width:s,height:c}}of f)if(o.offsetParent)if(o===r)e.$update(4,c),t.$update(4,s);else{const e=n.get(o);if(e){const[t,o]=e,r=i(t,o),n=l.get(r);let f,$;n?(n[0]!==c&&(f=!0),n[1]!==s&&($=!0)):f=$=!0,f&&a.add(t),$&&u.add(o),(f||$)&&l.set(r,[c,s])}}if(a.size){const t=[];a.forEach((e=>{let r=0;c.forEach((t=>{const n=l.get(i(e,t));n&&(r=o(r,n[0]))})),r&&t.push([e,r])})),e.$update(3,t)}if(u.size){const e=[];u.forEach((t=>{let r=0;s.forEach((e=>{const n=l.get(i(e,t));n&&(r=o(r,n[1]))})),r&&e.push([t,r])})),t.$update(3,e)}}));return{$observeRoot(e){f.v(r=e)},$observeItem:(e,t,o)=>(n.set(e,[t,o]),s.add(t),c.add(o),f.v(e),()=>{n.delete(e),f.S(e)}),$resizeCols(o){for(const[t]of o)for(let o=0;o<e.$getItemsLength();o++)l.delete(i(o,t));t.$update(3,o)},$resizeRows(o){for(const[e]of o)for(let o=0;o<t.$getItemsLength();o++)l.delete(i(e,o));e.$update(3,o)},$dispose:f.p}};export{I as ACTION_ITEMS_LENGTH_CHANGE,x as ACTION_START_OFFSET_CHANGE,z as UPDATE_SCROLL_END_EVENT,_ as UPDATE_SCROLL_EVENT,y as UPDATE_VIRTUAL_STATE,X as createGridResizer,O as createGridScroller,q as createResizer,C as createScroller,M as createVirtualStore,V as createWindowResizer,L as createWindowScroller,T as getScrollSize,m as isBrowser,w as isRTLDocument,l as microtask,c as sort};
//# sourceMappingURL=index.js.map
