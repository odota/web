"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const os_family_1 = require("os-family");
const resolve_cwd_1 = __importDefault(require("resolve-cwd"));
const promisified_functions_1 = require("./promisified-functions");
const FFMPEG_MODULE_NAME = '@ffmpeg-installer/ffmpeg';
const FFMPEG_SEARCH_COMMAND = os_family_1.isWin ? 'where' : 'which';
const FFMPEG_BINARY_NAME = 'ffmpeg';
async function findFFMPEGinPath() {
    try {
        const ffmpegPath = await (0, promisified_functions_1.exec)(`${FFMPEG_SEARCH_COMMAND} ${FFMPEG_BINARY_NAME}`);
        return ffmpegPath.stdout.trim();
    }
    catch (e) {
        return '';
    }
}
async function requireFFMPEGModuleFromCwd() {
    try {
        const ffmpegModulePath = (0, resolve_cwd_1.default)(FFMPEG_MODULE_NAME);
        return require(ffmpegModulePath).path;
    }
    catch (e) {
        return '';
    }
}
async function requireFFMPEGModule() {
    try {
        return require(FFMPEG_MODULE_NAME).path;
    }
    catch (e) {
        return '';
    }
}
async function default_1() {
    return process.env.FFMPEG_PATH ||
        await requireFFMPEGModuleFromCwd() ||
        await requireFFMPEGModule() ||
        await findFFMPEGinPath();
}
exports.default = default_1;
module.exports = exports.default;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGV0ZWN0LWZmbXBlZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlscy9kZXRlY3QtZmZtcGVnLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEseUNBQWtDO0FBQ2xDLDhEQUFxQztBQUNyQyxtRUFBK0M7QUFFL0MsTUFBTSxrQkFBa0IsR0FBTSwwQkFBMEIsQ0FBQztBQUN6RCxNQUFNLHFCQUFxQixHQUFHLGlCQUFLLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDO0FBQ3hELE1BQU0sa0JBQWtCLEdBQU0sUUFBUSxDQUFDO0FBRXZDLEtBQUssVUFBVSxnQkFBZ0I7SUFDM0IsSUFBSTtRQUNBLE1BQU0sVUFBVSxHQUFHLE1BQU0sSUFBQSw0QkFBSSxFQUFDLEdBQUcscUJBQXFCLElBQUksa0JBQWtCLEVBQUUsQ0FBQyxDQUFDO1FBRWhGLE9BQU8sVUFBVSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQztLQUNuQztJQUNELE9BQU8sQ0FBQyxFQUFFO1FBQ04sT0FBTyxFQUFFLENBQUM7S0FDYjtBQUNMLENBQUM7QUFFRCxLQUFLLFVBQVUsMEJBQTBCO0lBQ3JDLElBQUk7UUFDQSxNQUFNLGdCQUFnQixHQUFHLElBQUEscUJBQVUsRUFBQyxrQkFBa0IsQ0FBQyxDQUFDO1FBRXhELE9BQU8sT0FBTyxDQUFDLGdCQUFnQixDQUFDLENBQUMsSUFBSSxDQUFDO0tBQ3pDO0lBQ0QsT0FBTyxDQUFDLEVBQUU7UUFDTixPQUFPLEVBQUUsQ0FBQztLQUNiO0FBQ0wsQ0FBQztBQUVELEtBQUssVUFBVSxtQkFBbUI7SUFDOUIsSUFBSTtRQUNBLE9BQU8sT0FBTyxDQUFDLGtCQUFrQixDQUFDLENBQUMsSUFBSSxDQUFDO0tBQzNDO0lBQ0QsT0FBTyxDQUFDLEVBQUU7UUFDTixPQUFPLEVBQUUsQ0FBQztLQUNiO0FBQ0wsQ0FBQztBQUVjLEtBQUs7SUFDaEIsT0FBTyxPQUFPLENBQUMsR0FBRyxDQUFDLFdBQVc7UUFDMUIsTUFBTSwwQkFBMEIsRUFBRTtRQUNsQyxNQUFNLG1CQUFtQixFQUFFO1FBQzNCLE1BQU0sZ0JBQWdCLEVBQUUsQ0FBQztBQUNqQyxDQUFDO0FBTEQsNEJBS0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc1dpbiB9IGZyb20gJ29zLWZhbWlseSc7XG5pbXBvcnQgcmVzb2x2ZUN3ZCBmcm9tICdyZXNvbHZlLWN3ZCc7XG5pbXBvcnQgeyBleGVjIH0gZnJvbSAnLi9wcm9taXNpZmllZC1mdW5jdGlvbnMnO1xuXG5jb25zdCBGRk1QRUdfTU9EVUxFX05BTUUgICAgPSAnQGZmbXBlZy1pbnN0YWxsZXIvZmZtcGVnJztcbmNvbnN0IEZGTVBFR19TRUFSQ0hfQ09NTUFORCA9IGlzV2luID8gJ3doZXJlJyA6ICd3aGljaCc7XG5jb25zdCBGRk1QRUdfQklOQVJZX05BTUUgICAgPSAnZmZtcGVnJztcblxuYXN5bmMgZnVuY3Rpb24gZmluZEZGTVBFR2luUGF0aCAoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZmZtcGVnUGF0aCA9IGF3YWl0IGV4ZWMoYCR7RkZNUEVHX1NFQVJDSF9DT01NQU5EfSAke0ZGTVBFR19CSU5BUllfTkFNRX1gKTtcblxuICAgICAgICByZXR1cm4gZmZtcGVnUGF0aC5zdGRvdXQudHJpbSgpO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiByZXF1aXJlRkZNUEVHTW9kdWxlRnJvbUN3ZCAoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZmZtcGVnTW9kdWxlUGF0aCA9IHJlc29sdmVDd2QoRkZNUEVHX01PRFVMRV9OQU1FKTtcblxuICAgICAgICByZXR1cm4gcmVxdWlyZShmZm1wZWdNb2R1bGVQYXRoKS5wYXRoO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiByZXF1aXJlRkZNUEVHTW9kdWxlICgpIHtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gcmVxdWlyZShGRk1QRUdfTU9EVUxFX05BTUUpLnBhdGg7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gcHJvY2Vzcy5lbnYuRkZNUEVHX1BBVEggfHxcbiAgICAgICAgYXdhaXQgcmVxdWlyZUZGTVBFR01vZHVsZUZyb21Dd2QoKSB8fFxuICAgICAgICBhd2FpdCByZXF1aXJlRkZNUEVHTW9kdWxlKCkgfHxcbiAgICAgICAgYXdhaXQgZmluZEZGTVBFR2luUGF0aCgpO1xufVxuIl19