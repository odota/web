"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const base_1 = __importDefault(require("./base"));
const unquote_1 = __importDefault(require("unquote"));
const OPTIONS_SEPARATOR = ';';
const ARRAY_ITEMS_SEPARATOR = ',';
const TYPESCRIPT_OPTIONS_PREFIX = 'typescript.options.';
const TYPESCRIPT_ARRAY_OPTION_NAMES = ['rootDirs', 'types', 'typeRoots', 'lib'].map(optionName => TYPESCRIPT_OPTIONS_PREFIX + optionName);
function isTypeScriptArrayOption(name) {
    return !!name && TYPESCRIPT_ARRAY_OPTION_NAMES.includes(name);
}
function convertToArray(value) {
    if (!value)
        return [];
    return value
        .split(ARRAY_ITEMS_SEPARATOR)
        .map(unquote_1.default);
}
function convertToArrayIfNecessary(key, value) {
    return isTypeScriptArrayOption(key) ? convertToArray(value) : value;
}
async function default_1(options) {
    return base_1.default(options, {
        optionsSeparator: OPTIONS_SEPARATOR,
        async onOptionParsed(key, value) {
            return convertToArrayIfNecessary(key, value);
        },
    });
}
exports.default = default_1;
module.exports = exports.default;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcGlsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvdXRpbHMvZ2V0LW9wdGlvbnMvY29tcGlsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxrREFBb0M7QUFFcEMsc0RBQThCO0FBRTlCLE1BQU0saUJBQWlCLEdBQU8sR0FBRyxDQUFDO0FBQ2xDLE1BQU0scUJBQXFCLEdBQUcsR0FBRyxDQUFDO0FBRWxDLE1BQU0seUJBQXlCLEdBQUcscUJBQXFCLENBQUM7QUFFeEQsTUFBTSw2QkFBNkIsR0FBRyxDQUFDLFVBQVUsRUFBRSxPQUFPLEVBQUUsV0FBVyxFQUFFLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLHlCQUF5QixHQUFHLFVBQVUsQ0FBQyxDQUFDO0FBRTFJLFNBQVMsdUJBQXVCLENBQUUsSUFBWTtJQUMxQyxPQUFPLENBQUMsQ0FBQyxJQUFJLElBQUksNkJBQTZCLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ2xFLENBQUM7QUFFRCxTQUFTLGNBQWMsQ0FBRSxLQUFhO0lBQ2xDLElBQUksQ0FBQyxLQUFLO1FBQ04sT0FBTyxFQUFFLENBQUM7SUFFZCxPQUFPLEtBQUs7U0FDUCxLQUFLLENBQUMscUJBQXFCLENBQUM7U0FDNUIsR0FBRyxDQUFDLGlCQUFPLENBQUMsQ0FBQztBQUN0QixDQUFDO0FBRUQsU0FBUyx5QkFBeUIsQ0FBRSxHQUFXLEVBQUUsS0FBYTtJQUMxRCxPQUFPLHVCQUF1QixDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQztBQUN4RSxDQUFDO0FBRWMsS0FBSyxvQkFBVyxPQUFlO0lBQzFDLE9BQU8sY0FBYyxDQUFDLE9BQU8sRUFBRTtRQUMzQixnQkFBZ0IsRUFBRSxpQkFBaUI7UUFFbkMsS0FBSyxDQUFDLGNBQWMsQ0FBRSxHQUFXLEVBQUUsS0FBYTtZQUM1QyxPQUFPLHlCQUF5QixDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNqRCxDQUFDO0tBQ0osQ0FBQyxDQUFDO0FBQ1AsQ0FBQztBQVJELDRCQVFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGJhc2VHZXRPcHRpb25zIGZyb20gJy4vYmFzZSc7XG5pbXBvcnQgeyBEaWN0aW9uYXJ5IH0gZnJvbSAnLi4vLi4vY29uZmlndXJhdGlvbi9pbnRlcmZhY2VzJztcbmltcG9ydCB1bnF1b3RlIGZyb20gJ3VucXVvdGUnO1xuXG5jb25zdCBPUFRJT05TX1NFUEFSQVRPUiAgICAgPSAnOyc7XG5jb25zdCBBUlJBWV9JVEVNU19TRVBBUkFUT1IgPSAnLCc7XG5cbmNvbnN0IFRZUEVTQ1JJUFRfT1BUSU9OU19QUkVGSVggPSAndHlwZXNjcmlwdC5vcHRpb25zLic7XG5cbmNvbnN0IFRZUEVTQ1JJUFRfQVJSQVlfT1BUSU9OX05BTUVTID0gWydyb290RGlycycsICd0eXBlcycsICd0eXBlUm9vdHMnLCAnbGliJ10ubWFwKG9wdGlvbk5hbWUgPT4gVFlQRVNDUklQVF9PUFRJT05TX1BSRUZJWCArIG9wdGlvbk5hbWUpO1xuXG5mdW5jdGlvbiBpc1R5cGVTY3JpcHRBcnJheU9wdGlvbiAobmFtZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICEhbmFtZSAmJiBUWVBFU0NSSVBUX0FSUkFZX09QVElPTl9OQU1FUy5pbmNsdWRlcyhuYW1lKTtcbn1cblxuZnVuY3Rpb24gY29udmVydFRvQXJyYXkgKHZhbHVlOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgaWYgKCF2YWx1ZSlcbiAgICAgICAgcmV0dXJuIFtdO1xuXG4gICAgcmV0dXJuIHZhbHVlXG4gICAgICAgIC5zcGxpdChBUlJBWV9JVEVNU19TRVBBUkFUT1IpXG4gICAgICAgIC5tYXAodW5xdW90ZSk7XG59XG5cbmZ1bmN0aW9uIGNvbnZlcnRUb0FycmF5SWZOZWNlc3NhcnkgKGtleTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogc3RyaW5nW10gfCBzdHJpbmcge1xuICAgIHJldHVybiBpc1R5cGVTY3JpcHRBcnJheU9wdGlvbihrZXkpID8gY29udmVydFRvQXJyYXkodmFsdWUpIDogdmFsdWU7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIChvcHRpb25zOiBzdHJpbmcpOiBQcm9taXNlPERpY3Rpb25hcnk8bnVtYmVyIHwgc3RyaW5nIHwgYm9vbGVhbj4+IHtcbiAgICByZXR1cm4gYmFzZUdldE9wdGlvbnMob3B0aW9ucywge1xuICAgICAgICBvcHRpb25zU2VwYXJhdG9yOiBPUFRJT05TX1NFUEFSQVRPUixcblxuICAgICAgICBhc3luYyBvbk9wdGlvblBhcnNlZCAoa2V5OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiBjb252ZXJ0VG9BcnJheUlmTmVjZXNzYXJ5KGtleSwgdmFsdWUpO1xuICAgICAgICB9LFxuICAgIH0pO1xufVxuIl19