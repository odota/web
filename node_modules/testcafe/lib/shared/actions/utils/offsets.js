"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getOffsetOptions = exports.getDefaultAutomationOffsets = void 0;
const adapter_1 = require("../../adapter");
function calcOffset(size) {
    const offset = size / 2;
    return offset < 1 ? 0 : Math.round(offset);
}
async function getDefaultAutomationOffsets(element) {
    const rect = await adapter_1.adapter.position.getElementRectangle(element);
    const offsetX = calcOffset(rect.width);
    const offsetY = calcOffset(rect.height);
    return { offsetX, offsetY };
}
exports.getDefaultAutomationOffsets = getDefaultAutomationOffsets;
async function getOffsetOptions(element, offsetX, offsetY) {
    const defaultOffsets = await getDefaultAutomationOffsets(element);
    offsetX = typeof offsetX === 'number' ? Math.round(offsetX) : defaultOffsets.offsetX;
    offsetY = typeof offsetY === 'number' ? Math.round(offsetY) : defaultOffsets.offsetY;
    if (offsetX > 0 && offsetY > 0)
        return { offsetX, offsetY };
    const dimensions = await adapter_1.adapter.position.getClientDimensions(element);
    const width = Math.round(Math.max(element.scrollWidth, dimensions.width));
    const height = Math.round(Math.max(element.scrollHeight, dimensions.height));
    const maxX = dimensions.scrollbar.right + dimensions.border.left + dimensions.border.right + width;
    const maxY = dimensions.scrollbar.bottom + dimensions.border.top + dimensions.border.bottom + height;
    return {
        offsetX: offsetX < 0 ? maxX + offsetX : offsetX,
        offsetY: offsetY < 0 ? maxY + offsetY : offsetY,
    };
}
exports.getOffsetOptions = getOffsetOptions;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2Zmc2V0cy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9zaGFyZWQvYWN0aW9ucy91dGlscy9vZmZzZXRzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLDJDQUF3QztBQUV4QyxTQUFTLFVBQVUsQ0FBRSxJQUFZO0lBQzdCLE1BQU0sTUFBTSxHQUFHLElBQUksR0FBRyxDQUFDLENBQUM7SUFFeEIsT0FBTyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDL0MsQ0FBQztBQUVNLEtBQUssVUFBVSwyQkFBMkIsQ0FBRSxPQUFZO0lBQzNELE1BQU0sSUFBSSxHQUFNLE1BQU0saUJBQU8sQ0FBQyxRQUFRLENBQUMsbUJBQW1CLENBQUMsT0FBTyxDQUFDLENBQUM7SUFFcEUsTUFBTSxPQUFPLEdBQUcsVUFBVSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN2QyxNQUFNLE9BQU8sR0FBRyxVQUFVLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBRXhDLE9BQU8sRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLENBQUM7QUFDaEMsQ0FBQztBQVBELGtFQU9DO0FBRU0sS0FBSyxVQUFVLGdCQUFnQixDQUFFLE9BQVksRUFBRSxPQUFnQixFQUFFLE9BQWdCO0lBQ3BGLE1BQU0sY0FBYyxHQUFHLE1BQU0sMkJBQTJCLENBQUMsT0FBTyxDQUFDLENBQUM7SUFFbEUsT0FBTyxHQUFHLE9BQU8sT0FBTyxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQztJQUNyRixPQUFPLEdBQUcsT0FBTyxPQUFPLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDO0lBRXJGLElBQUksT0FBTyxHQUFHLENBQUMsSUFBSSxPQUFPLEdBQUcsQ0FBQztRQUMxQixPQUFPLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxDQUFDO0lBRWhDLE1BQU0sVUFBVSxHQUFHLE1BQU0saUJBQU8sQ0FBQyxRQUFRLENBQUMsbUJBQW1CLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDdkUsTUFBTSxLQUFLLEdBQVEsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDL0UsTUFBTSxNQUFNLEdBQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxZQUFZLEVBQUUsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFDakYsTUFBTSxJQUFJLEdBQVMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxLQUFLLEdBQUcsVUFBVSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEdBQUcsVUFBVSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO0lBQ3pHLE1BQU0sSUFBSSxHQUFTLFVBQVUsQ0FBQyxTQUFTLENBQUMsTUFBTSxHQUFHLFVBQVUsQ0FBQyxNQUFNLENBQUMsR0FBRyxHQUFHLFVBQVUsQ0FBQyxNQUFNLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztJQUUzRyxPQUFPO1FBQ0gsT0FBTyxFQUFFLE9BQU8sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBRyxPQUFPLENBQUMsQ0FBQyxDQUFDLE9BQU87UUFDL0MsT0FBTyxFQUFFLE9BQU8sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBRyxPQUFPLENBQUMsQ0FBQyxDQUFDLE9BQU87S0FDbEQsQ0FBQztBQUNOLENBQUM7QUFuQkQsNENBbUJDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYWRhcHRlciB9IGZyb20gJy4uLy4uL2FkYXB0ZXInO1xuXG5mdW5jdGlvbiBjYWxjT2Zmc2V0IChzaXplOiBudW1iZXIpOiBudW1iZXIge1xuICAgIGNvbnN0IG9mZnNldCA9IHNpemUgLyAyO1xuXG4gICAgcmV0dXJuIG9mZnNldCA8IDEgPyAwIDogTWF0aC5yb3VuZChvZmZzZXQpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RGVmYXVsdEF1dG9tYXRpb25PZmZzZXRzIChlbGVtZW50OiBhbnkpOiBQcm9taXNlPHsgb2Zmc2V0WDogbnVtYmVyOyBvZmZzZXRZOiBudW1iZXIgfT4ge1xuICAgIGNvbnN0IHJlY3QgICAgPSBhd2FpdCBhZGFwdGVyLnBvc2l0aW9uLmdldEVsZW1lbnRSZWN0YW5nbGUoZWxlbWVudCk7XG5cbiAgICBjb25zdCBvZmZzZXRYID0gY2FsY09mZnNldChyZWN0LndpZHRoKTtcbiAgICBjb25zdCBvZmZzZXRZID0gY2FsY09mZnNldChyZWN0LmhlaWdodCk7XG5cbiAgICByZXR1cm4geyBvZmZzZXRYLCBvZmZzZXRZIH07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPZmZzZXRPcHRpb25zIChlbGVtZW50OiBhbnksIG9mZnNldFg/OiBudW1iZXIsIG9mZnNldFk/OiBudW1iZXIpOiBQcm9taXNlPHsgb2Zmc2V0WDogbnVtYmVyOyBvZmZzZXRZOiBudW1iZXIgfT4ge1xuICAgIGNvbnN0IGRlZmF1bHRPZmZzZXRzID0gYXdhaXQgZ2V0RGVmYXVsdEF1dG9tYXRpb25PZmZzZXRzKGVsZW1lbnQpO1xuXG4gICAgb2Zmc2V0WCA9IHR5cGVvZiBvZmZzZXRYID09PSAnbnVtYmVyJyA/IE1hdGgucm91bmQob2Zmc2V0WCkgOiBkZWZhdWx0T2Zmc2V0cy5vZmZzZXRYO1xuICAgIG9mZnNldFkgPSB0eXBlb2Ygb2Zmc2V0WSA9PT0gJ251bWJlcicgPyBNYXRoLnJvdW5kKG9mZnNldFkpIDogZGVmYXVsdE9mZnNldHMub2Zmc2V0WTtcblxuICAgIGlmIChvZmZzZXRYID4gMCAmJiBvZmZzZXRZID4gMClcbiAgICAgICAgcmV0dXJuIHsgb2Zmc2V0WCwgb2Zmc2V0WSB9O1xuXG4gICAgY29uc3QgZGltZW5zaW9ucyA9IGF3YWl0IGFkYXB0ZXIucG9zaXRpb24uZ2V0Q2xpZW50RGltZW5zaW9ucyhlbGVtZW50KTtcbiAgICBjb25zdCB3aWR0aCAgICAgID0gTWF0aC5yb3VuZChNYXRoLm1heChlbGVtZW50LnNjcm9sbFdpZHRoLCBkaW1lbnNpb25zLndpZHRoKSk7XG4gICAgY29uc3QgaGVpZ2h0ICAgICA9IE1hdGgucm91bmQoTWF0aC5tYXgoZWxlbWVudC5zY3JvbGxIZWlnaHQsIGRpbWVuc2lvbnMuaGVpZ2h0KSk7XG4gICAgY29uc3QgbWF4WCAgICAgICA9IGRpbWVuc2lvbnMuc2Nyb2xsYmFyLnJpZ2h0ICsgZGltZW5zaW9ucy5ib3JkZXIubGVmdCArIGRpbWVuc2lvbnMuYm9yZGVyLnJpZ2h0ICsgd2lkdGg7XG4gICAgY29uc3QgbWF4WSAgICAgICA9IGRpbWVuc2lvbnMuc2Nyb2xsYmFyLmJvdHRvbSArIGRpbWVuc2lvbnMuYm9yZGVyLnRvcCArIGRpbWVuc2lvbnMuYm9yZGVyLmJvdHRvbSArIGhlaWdodDtcblxuICAgIHJldHVybiB7XG4gICAgICAgIG9mZnNldFg6IG9mZnNldFggPCAwID8gbWF4WCArIG9mZnNldFggOiBvZmZzZXRYLFxuICAgICAgICBvZmZzZXRZOiBvZmZzZXRZIDwgMCA/IG1heFkgKyBvZmZzZXRZIDogb2Zmc2V0WSxcbiAgICB9O1xufVxuIl19