import{c as ze,D as Me,P as T,R as m,E as Oe,F as Be,z as Le,G as Ve,H as ue,I as Je,J as xe,K as Pe,L as We,M as Te,N as de,O as He,Q as Ee,B as Se,A as Ge,S as Re,U as Qe,V as Ke,W as Ye,X as Ze,Y as Xe,Z as et}from"./index-78f7331a.js";var qe={exports:{}};/* @license
Papa Parse
v5.3.2
https://github.com/mholt/PapaParse
License: MIT
*/(function(v,i){(function(f,a){v.exports=a()})(ze,function f(){var a=typeof self<"u"?self:typeof window<"u"?window:a!==void 0?a:{},h=!a.document&&!!a.postMessage,A=h&&/blob:/i.test((a.location||{}).protocol),g={},I=0,s={parse:function(t,e){var n=(e=e||{}).dynamicTyping||!1;if(D(n)&&(e.dynamicTypingFunction=n,n={}),e.dynamicTyping=n,e.transform=!!D(e.transform)&&e.transform,e.worker&&s.WORKERS_SUPPORTED){var u=function(){if(!s.WORKERS_SUPPORTED)return!1;var c=(R=a.URL||a.webkitURL||null,o=f.toString(),s.BLOB_URL||(s.BLOB_URL=R.createObjectURL(new Blob(["(",o,")();"],{type:"text/javascript"})))),d=new a.Worker(c),R,o;return d.onmessage=he,d.id=I++,g[d.id]=d}();return u.userStep=e.step,u.userChunk=e.chunk,u.userComplete=e.complete,u.userError=e.error,e.step=D(e.step),e.chunk=D(e.chunk),e.complete=D(e.complete),e.error=D(e.error),delete e.worker,void u.postMessage({input:t,config:e,workerId:u.id})}var l=null;return s.NODE_STREAM_INPUT,typeof t=="string"?l=e.download?new Q(e):new b(e):t.readable===!0&&D(t.read)&&D(t.on)?l=new re(e):(a.File&&t instanceof File||t instanceof Object)&&(l=new r(e)),l.stream(t)},unparse:function(t,e){var n=!1,u=!0,l=",",c=`\r
`,d='"',R=d+d,o=!1,p=null,q=!1;(function(){if(typeof e=="object"){if(typeof e.delimiter!="string"||s.BAD_DELIMITERS.filter(function(_){return e.delimiter.indexOf(_)!==-1}).length||(l=e.delimiter),(typeof e.quotes=="boolean"||typeof e.quotes=="function"||Array.isArray(e.quotes))&&(n=e.quotes),typeof e.skipEmptyLines!="boolean"&&typeof e.skipEmptyLines!="string"||(o=e.skipEmptyLines),typeof e.newline=="string"&&(c=e.newline),typeof e.quoteChar=="string"&&(d=e.quoteChar),typeof e.header=="boolean"&&(u=e.header),Array.isArray(e.columns)){if(e.columns.length===0)throw new Error("Option columns is empty");p=e.columns}e.escapeChar!==void 0&&(R=e.escapeChar+d),(typeof e.escapeFormulae=="boolean"||e.escapeFormulae instanceof RegExp)&&(q=e.escapeFormulae instanceof RegExp?e.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var x=new RegExp(se(d),"g");if(typeof t=="string"&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return ee(null,t,o);if(typeof t[0]=="object")return ee(p||Object.keys(t[0]),t,o)}else if(typeof t=="object")return typeof t.data=="string"&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields||p),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:typeof t.data[0]=="object"?Object.keys(t.data[0]):[]),Array.isArray(t.data[0])||typeof t.data[0]=="object"||(t.data=[t.data])),ee(t.fields||[],t.data||[],o);throw new Error("Unable to serialize unrecognized input");function ee(_,N,W){var L="";typeof _=="string"&&(_=JSON.parse(_)),typeof N=="string"&&(N=JSON.parse(N));var V=Array.isArray(_)&&0<_.length,M=!Array.isArray(N[0]);if(V&&u){for(var B=0;B<_.length;B++)0<B&&(L+=l),L+=J(_[B],B);0<N.length&&(L+=c)}for(var k=0;k<N.length;k++){var w=V?_.length:N[k].length,j=!1,U=V?Object.keys(N[k]).length===0:N[k].length===0;if(W&&!V&&(j=W==="greedy"?N[k].join("").trim()==="":N[k].length===1&&N[k][0].length===0),W==="greedy"&&V){for(var S=[],$=0;$<w;$++){var P=M?_[$]:$;S.push(N[k][P])}j=S.join("").trim()===""}if(!j){for(var E=0;E<w;E++){0<E&&!U&&(L+=l);var le=V&&M?_[E]:E;L+=J(N[k][le],E)}k<N.length-1&&(!W||0<w&&!U)&&(L+=c)}}return L}function J(_,N){if(_==null)return"";if(_.constructor===Date)return JSON.stringify(_).slice(1,25);var W=!1;q&&typeof _=="string"&&q.test(_)&&(_="'"+_,W=!0);var L=_.toString().replace(x,R);return(W=W||n===!0||typeof n=="function"&&n(_,N)||Array.isArray(n)&&n[N]||function(V,M){for(var B=0;B<M.length;B++)if(-1<V.indexOf(M[B]))return!0;return!1}(L,s.BAD_DELIMITERS)||-1<L.indexOf(l)||L.charAt(0)===" "||L.charAt(L.length-1)===" ")?d+L+d:L}}};if(s.RECORD_SEP=String.fromCharCode(30),s.UNIT_SEP=String.fromCharCode(31),s.BYTE_ORDER_MARK="\uFEFF",s.BAD_DELIMITERS=["\r",`
`,'"',s.BYTE_ORDER_MARK],s.WORKERS_SUPPORTED=!h&&!!a.Worker,s.NODE_STREAM_INPUT=1,s.LocalChunkSize=10485760,s.RemoteChunkSize=5242880,s.DefaultDelimiter=",",s.Parser=ne,s.ParserHandle=ke,s.NetworkStreamer=Q,s.FileStreamer=r,s.StringStreamer=b,s.ReadableStreamStreamer=re,a.jQuery){var y=a.jQuery;y.fn.parse=function(t){var e=t.config||{},n=[];return this.each(function(c){if(!(y(this).prop("tagName").toUpperCase()==="INPUT"&&y(this).attr("type").toLowerCase()==="file"&&a.FileReader)||!this.files||this.files.length===0)return!0;for(var d=0;d<this.files.length;d++)n.push({file:this.files[d],inputElem:this,instanceConfig:y.extend({},e)})}),u(),this;function u(){if(n.length!==0){var c,d,R,o,p=n[0];if(D(t.before)){var q=t.before(p.file,p.inputElem);if(typeof q=="object"){if(q.action==="abort")return c="AbortError",d=p.file,R=p.inputElem,o=q.reason,void(D(t.error)&&t.error({name:c},d,R,o));if(q.action==="skip")return void l();typeof q.config=="object"&&(p.instanceConfig=y.extend(p.instanceConfig,q.config))}else if(q==="skip")return void l()}var x=p.instanceConfig.complete;p.instanceConfig.complete=function(ee){D(x)&&x(ee,p.file,p.inputElem),l()},s.parse(p.file,p.instanceConfig)}else D(t.complete)&&t.complete()}function l(){n.splice(0,1),u()}}}function C(t){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var n=pe(e);n.chunkSize=parseInt(n.chunkSize),e.step||e.chunk||(n.chunkSize=null),this._handle=new ke(n),(this._handle.streamer=this)._config=n}.call(this,t),this.parseChunk=function(e,n){if(this.isFirstChunk&&D(this._config.beforeFirstChunk)){var u=this._config.beforeFirstChunk(e);u!==void 0&&(e=u)}this.isFirstChunk=!1,this._halted=!1;var l=this._partialLine+e;this._partialLine="";var c=this._handle.parse(l,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var d=c.meta.cursor;this._finished||(this._partialLine=l.substring(d-this._baseIndex),this._baseIndex=d),c&&c.data&&(this._rowCount+=c.data.length);var R=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(A)a.postMessage({results:c,workerId:s.WORKER_ID,finished:R});else if(D(this._config.chunk)&&!n){if(this._config.chunk(c,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);c=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(c.data),this._completeResults.errors=this._completeResults.errors.concat(c.errors),this._completeResults.meta=c.meta),this._completed||!R||!D(this._config.complete)||c&&c.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),R||c&&c.meta.paused||this._nextChunk(),c}this._halted=!0},this._sendError=function(e){D(this._config.error)?this._config.error(e):A&&this._config.error&&a.postMessage({workerId:s.WORKER_ID,error:e,finished:!1})}}function Q(t){var e;(t=t||{}).chunkSize||(t.chunkSize=s.RemoteChunkSize),C.call(this,t),this._nextChunk=h?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(n){this._input=n,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(e=new XMLHttpRequest,this._config.withCredentials&&(e.withCredentials=this._config.withCredentials),h||(e.onload=Z(this._chunkLoaded,this),e.onerror=Z(this._chunkError,this)),e.open(this._config.downloadRequestBody?"POST":"GET",this._input,!h),this._config.downloadRequestHeaders){var n=this._config.downloadRequestHeaders;for(var u in n)e.setRequestHeader(u,n[u])}if(this._config.chunkSize){var l=this._start+this._config.chunkSize-1;e.setRequestHeader("Range","bytes="+this._start+"-"+l)}try{e.send(this._config.downloadRequestBody)}catch(c){this._chunkError(c.message)}h&&e.status===0&&this._chunkError()}},this._chunkLoaded=function(){e.readyState===4&&(e.status<200||400<=e.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:e.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(n){var u=n.getResponseHeader("Content-Range");return u===null?-1:parseInt(u.substring(u.lastIndexOf("/")+1))}(e),this.parseChunk(e.responseText)))},this._chunkError=function(n){var u=e.statusText||n;this._sendError(new Error(u))}}function r(t){var e,n;(t=t||{}).chunkSize||(t.chunkSize=s.LocalChunkSize),C.call(this,t);var u=typeof FileReader<"u";this.stream=function(l){this._input=l,n=l.slice||l.webkitSlice||l.mozSlice,u?((e=new FileReader).onload=Z(this._chunkLoaded,this),e.onerror=Z(this._chunkError,this)):e=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var l=this._input;if(this._config.chunkSize){var c=Math.min(this._start+this._config.chunkSize,this._input.size);l=n.call(l,this._start,c)}var d=e.readAsText(l,this._config.encoding);u||this._chunkLoaded({target:{result:d}})},this._chunkLoaded=function(l){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(l.target.result)},this._chunkError=function(){this._sendError(e.error)}}function b(t){var e;C.call(this,t=t||{}),this.stream=function(n){return e=n,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var n,u=this._config.chunkSize;return u?(n=e.substring(0,u),e=e.substring(u)):(n=e,e=""),this._finished=!e,this.parseChunk(n)}}}function re(t){C.call(this,t=t||{});var e=[],n=!0,u=!1;this.pause=function(){C.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){C.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(l){this._input=l,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){u&&e.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),e.length?this.parseChunk(e.shift()):n=!0},this._streamData=Z(function(l){try{e.push(typeof l=="string"?l:l.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(e.shift()))}catch(c){this._streamError(c)}},this),this._streamError=Z(function(l){this._streamCleanUp(),this._sendError(l)},this),this._streamEnd=Z(function(){this._streamCleanUp(),u=!0,this._streamData("")},this),this._streamCleanUp=Z(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function ke(t){var e,n,u,l=Math.pow(2,53),c=-l,d=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,R=/^(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))$/,o=this,p=0,q=0,x=!1,ee=!1,J=[],_={data:[],errors:[],meta:{}};if(D(t.step)){var N=t.step;t.step=function(k){if(_=k,V())L();else{if(L(),_.data.length===0)return;p+=k.data.length,t.preview&&p>t.preview?n.abort():(_.data=_.data[0],N(_,o))}}}function W(k){return t.skipEmptyLines==="greedy"?k.join("").trim()==="":k.length===1&&k[0].length===0}function L(){return _&&u&&(B("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+s.DefaultDelimiter+"'"),u=!1),t.skipEmptyLines&&(_.data=_.data.filter(function(k){return!W(k)})),V()&&function(){if(!_)return;function k(j,U){D(t.transformHeader)&&(j=t.transformHeader(j,U)),J.push(j)}if(Array.isArray(_.data[0])){for(var w=0;V()&&w<_.data.length;w++)_.data[w].forEach(k);_.data.splice(0,1)}else _.data.forEach(k)}(),function(){if(!_||!t.header&&!t.dynamicTyping&&!t.transform)return _;function k(j,U){var S,$=t.header?{}:[];for(S=0;S<j.length;S++){var P=S,E=j[S];t.header&&(P=S>=J.length?"__parsed_extra":J[S]),t.transform&&(E=t.transform(E,P)),E=M(P,E),P==="__parsed_extra"?($[P]=$[P]||[],$[P].push(E)):$[P]=E}return t.header&&(S>J.length?B("FieldMismatch","TooManyFields","Too many fields: expected "+J.length+" fields but parsed "+S,q+U):S<J.length&&B("FieldMismatch","TooFewFields","Too few fields: expected "+J.length+" fields but parsed "+S,q+U)),$}var w=1;return!_.data.length||Array.isArray(_.data[0])?(_.data=_.data.map(k),w=_.data.length):_.data=k(_.data,0),t.header&&_.meta&&(_.meta.fields=J),q+=w,_}()}function V(){return t.header&&J.length===0}function M(k,w){return j=k,t.dynamicTypingFunction&&t.dynamicTyping[j]===void 0&&(t.dynamicTyping[j]=t.dynamicTypingFunction(j)),(t.dynamicTyping[j]||t.dynamicTyping)===!0?w==="true"||w==="TRUE"||w!=="false"&&w!=="FALSE"&&(function(U){if(d.test(U)){var S=parseFloat(U);if(c<S&&S<l)return!0}return!1}(w)?parseFloat(w):R.test(w)?new Date(w):w===""?null:w):w;var j}function B(k,w,j,U){var S={type:k,code:w,message:j};U!==void 0&&(S.row=U),_.errors.push(S)}this.parse=function(k,w,j){var U=t.quoteChar||'"';if(t.newline||(t.newline=function(P,E){P=P.substring(0,1048576);var le=new RegExp(se(E)+"([^]*?)"+se(E),"gm"),X=(P=P.replace(le,"")).split("\r"),K=P.split(`
`),oe=1<K.length&&K[0].length<X[0].length;if(X.length===1||oe)return`
`;for(var te=0,Y=0;Y<X.length;Y++)X[Y][0]===`
`&&te++;return te>=X.length/2?`\r
`:"\r"}(k,U)),u=!1,t.delimiter)D(t.delimiter)&&(t.delimiter=t.delimiter(k),_.meta.delimiter=t.delimiter);else{var S=function(P,E,le,X,K){var oe,te,Y,H;K=K||[",","	","|",";",s.RECORD_SEP,s.UNIT_SEP];for(var ce=0;ce<K.length;ce++){var G=K[ce],_e=0,ie=0,De=0;Y=void 0;for(var fe=new ne({comments:X,delimiter:G,newline:E,preview:10}).parse(P),ve=0;ve<fe.data.length;ve++)if(le&&W(fe.data[ve]))De++;else{var ge=fe.data[ve].length;ie+=ge,Y!==void 0?0<ge&&(_e+=Math.abs(ge-Y),Y=ge):Y=ge}0<fe.data.length&&(ie/=fe.data.length-De),(te===void 0||_e<=te)&&(H===void 0||H<ie)&&1.99<ie&&(te=_e,oe=G,H=ie)}return{successful:!!(t.delimiter=oe),bestDelimiter:oe}}(k,t.newline,t.skipEmptyLines,t.comments,t.delimitersToGuess);S.successful?t.delimiter=S.bestDelimiter:(u=!0,t.delimiter=s.DefaultDelimiter),_.meta.delimiter=t.delimiter}var $=pe(t);return t.preview&&t.header&&$.preview++,e=k,n=new ne($),_=n.parse(e,w,j),L(),x?{meta:{paused:!0}}:_||{meta:{paused:!1}}},this.paused=function(){return x},this.pause=function(){x=!0,n.abort(),e=D(t.chunk)?"":e.substring(n.getCharIndex())},this.resume=function(){o.streamer._halted?(x=!1,o.streamer.parseChunk(e,!0)):setTimeout(o.resume,3)},this.aborted=function(){return ee},this.abort=function(){ee=!0,n.abort(),_.meta.aborted=!0,D(t.complete)&&t.complete(_),e=""}}function se(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ne(t){var e,n=(t=t||{}).delimiter,u=t.newline,l=t.comments,c=t.step,d=t.preview,R=t.fastMode,o=e=t.quoteChar===void 0||t.quoteChar===null?'"':t.quoteChar;if(t.escapeChar!==void 0&&(o=t.escapeChar),(typeof n!="string"||-1<s.BAD_DELIMITERS.indexOf(n))&&(n=","),l===n)throw new Error("Comment character same as delimiter");l===!0?l="#":(typeof l!="string"||-1<s.BAD_DELIMITERS.indexOf(l))&&(l=!1),u!==`
`&&u!=="\r"&&u!==`\r
`&&(u=`
`);var p=0,q=!1;this.parse=function(x,ee,J){if(typeof x!="string")throw new Error("Input must be a string");var _=x.length,N=n.length,W=u.length,L=l.length,V=D(c),M=[],B=[],k=[],w=p=0;if(!x)return H();if(R||R!==!1&&x.indexOf(e)===-1){for(var j=x.split(u),U=0;U<j.length;U++){if(k=j[U],p+=k.length,U!==j.length-1)p+=u.length;else if(J)return H();if(!l||k.substring(0,L)!==l){if(V){if(M=[],K(k.split(n)),ce(),q)return H()}else K(k.split(n));if(d&&d<=U)return M=M.slice(0,d),H(!0)}}return H()}for(var S=x.indexOf(n,p),$=x.indexOf(u,p),P=new RegExp(se(o)+se(e),"g"),E=x.indexOf(e,p);;)if(x[p]!==e)if(l&&k.length===0&&x.substring(p,p+L)===l){if($===-1)return H();p=$+W,$=x.indexOf(u,p),S=x.indexOf(n,p)}else if(S!==-1&&(S<$||$===-1))k.push(x.substring(p,S)),p=S+N,S=x.indexOf(n,p);else{if($===-1)break;if(k.push(x.substring(p,$)),Y($+W),V&&(ce(),q))return H();if(d&&M.length>=d)return H(!0)}else for(E=p,p++;;){if((E=x.indexOf(e,E+1))===-1)return J||B.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:M.length,index:p}),te();if(E===_-1)return te(x.substring(p,E).replace(P,e));if(e!==o||x[E+1]!==o){if(e===o||E===0||x[E-1]!==o){S!==-1&&S<E+1&&(S=x.indexOf(n,E+1)),$!==-1&&$<E+1&&($=x.indexOf(u,E+1));var le=oe($===-1?S:Math.min(S,$));if(x.substr(E+1+le,N)===n){k.push(x.substring(p,E).replace(P,e)),x[p=E+1+le+N]!==e&&(E=x.indexOf(e,p)),S=x.indexOf(n,p),$=x.indexOf(u,p);break}var X=oe($);if(x.substring(E+1+X,E+1+X+W)===u){if(k.push(x.substring(p,E).replace(P,e)),Y(E+1+X+W),S=x.indexOf(n,p),E=x.indexOf(e,p),V&&(ce(),q))return H();if(d&&M.length>=d)return H(!0);break}B.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:M.length,index:p}),E++}}else E++}return te();function K(G){M.push(G),w=p}function oe(G){var _e=0;if(G!==-1){var ie=x.substring(E+1,G);ie&&ie.trim()===""&&(_e=ie.length)}return _e}function te(G){return J||(G===void 0&&(G=x.substring(p)),k.push(G),p=_,K(k),V&&ce()),H()}function Y(G){p=G,K(k),k=[],$=x.indexOf(u,p)}function H(G){return{data:M,errors:B,meta:{delimiter:n,linebreak:u,aborted:q,truncated:!!G,cursor:w+(ee||0)}}}function ce(){c(H()),M=[],B=[]}},this.abort=function(){q=!0},this.getCharIndex=function(){return p}}function he(t){var e=t.data,n=g[e.workerId],u=!1;if(e.error)n.userError(e.error,e.file);else if(e.results&&e.results.data){var l={abort:function(){u=!0,ae(e.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:me,resume:me};if(D(n.userStep)){for(var c=0;c<e.results.data.length&&(n.userStep({data:e.results.data[c],errors:e.results.errors,meta:e.results.meta},l),!u);c++);delete e.results}else D(n.userChunk)&&(n.userChunk(e.results,l,e.file),delete e.results)}e.finished&&!u&&ae(e.workerId,e.results)}function ae(t,e){var n=g[t];D(n.userComplete)&&n.userComplete(e),n.terminate(),delete g[t]}function me(){throw new Error("Not implemented.")}function pe(t){if(typeof t!="object"||t===null)return t;var e=Array.isArray(t)?[]:{};for(var n in t)e[n]=pe(t[n]);return e}function Z(t,e){return function(){t.apply(e,arguments)}}function D(t){return typeof t=="function"}return A&&(a.onmessage=function(t){var e=t.data;if(s.WORKER_ID===void 0&&e&&(s.WORKER_ID=e.workerId),typeof e.input=="string")a.postMessage({workerId:s.WORKER_ID,results:s.parse(e.input,e.config),finished:!0});else if(a.File&&e.input instanceof File||e.input instanceof Object){var n=s.parse(e.input,e.config);n&&a.postMessage({workerId:s.WORKER_ID,results:n,finished:!0})}}),(Q.prototype=Object.create(C.prototype)).constructor=Q,(r.prototype=Object.create(C.prototype)).constructor=r,(b.prototype=Object.create(b.prototype)).constructor=b,(re.prototype=Object.create(C.prototype)).constructor=re,s})})(qe);var tt=qe.exports;const at=Me(tt);function O(v,i){if(!i)return"";const f=v[0],a=v[1];if(Array.isArray(i)){const h=i.map(g=>g.value),A=[];return i.length?(h.forEach(g=>{A.push(`${f}${g}${a}`)}),`AND (${A.join(" OR ")})`):""}return`AND ${f}${i.value!==void 0?i.value:i}${a}`}function z(v){return Array.isArray(v)&&v.length>0}const Ae=[7119388,2586976,6209166,8254400,7391077,7732977,8260983,8291895,8599101,350190,39,7390454,8131728,8605863,8721219,6209804,8597976,2163,1838315,15],it=v=>{const{select:i,group:f,minPatch:a,maxPatch:h,hero:A,player:g,league:I,playerPurchased:s,minDuration:y,maxDuration:C,side:Q,result:r,team:b,organization:re,laneRole:ke,region:se,minDate:ne,maxDate:he,order:ae,tier:me,having:pe,limit:Z,isTiTeam:D,megaWin:t,minGoldAdvantage:e,maxGoldAdvantage:n}=v;let u,l=[],c=[];if(Array.isArray(f)?l=f:l.push(f),Array.isArray(i)?c=i:c.push(i),c=c.filter(d=>d!==void 0),l=l.filter(d=>d!==void 0),l.forEach(d=>{d.json_each&&c.push(d)}),l=l.filter(d=>!d.json_each),c.forEach((d,R)=>{if(d&&d.groupValue){const o={value:d.groupKey,groupKeySelect:d.groupKeySelect,alias:d.alias,key:`key${R.toString()}`};if(d.groupKey==="key"){const p=d;o.value=`key${R.toString()}.key`,p.value=`key${R.toString()}.key`,p.join=`${d.join} key${R.toString()}`,p.groupValue=`key${R.toString()}.${d.groupValue}`}l.push(o)}}),z(c)&&c.some(d=>d.template==="picks_bans"))u=`SELECT
hero_id, 
count(1) total,
sum(is_pick::int) picks, 
sum((NOT is_pick)::int) bans,
sum((is_pick IS TRUE AND ord < 8)::int) first_pick, 
sum((is_pick IS FALSE AND ord < 8)::int) first_ban,
sum((is_pick IS TRUE AND ord >= 8 AND ord < 16)::int) second_pick, 
sum((is_pick IS FALSE AND ord >= 8 AND ord < 16)::int) second_ban,
sum((is_pick IS TRUE AND ord >= 16)::int) third_pick, 
sum((is_pick IS FALSE AND ord >= 16)::int) third_ban,
sum((radiant = radiant_win)::int)::float/count(1) winrate,
sum((radiant = radiant_win AND is_pick IS TRUE)::int)::float/NULLIF(sum(is_pick::int), 0) pick_winrate,
sum((radiant = radiant_win AND is_pick IS FALSE)::int)::float/NULLIF(sum((NOT is_pick)::int), 0) ban_winrate
FROM picks_bans
JOIN matches using(match_id)
JOIN match_patch using(match_id)
JOIN leagues using(leagueid)
JOIN team_match using(match_id)
JOIN teams using(team_id)
WHERE TRUE
${z(c)&&c.find(d=>d.where)!==void 0?c.find(d=>d.where).where:""}
${O`team_id = ${re}`}
${O`match_patch.patch >= '${a}'`}
${O`match_patch.patch <= '${h}'`}
${O`matches.leagueid = ${I}`}
${O`matches.duration >= ${y}`}
${O`matches.duration <= ${C}`}
${O`team_match.radiant = ${Q}`}
${O`(team_match.radiant = matches.radiant_win) = ${r}`}
${O`matches.cluster IN (${se})`}
${ne?O`matches.start_time >= extract(epoch from timestamp '${new Date(ne.value).toISOString()}')`:""}
${he?O`matches.start_time <= extract(epoch from timestamp '${new Date(he.value).toISOString()}')`:""}
${O`leagues.tier = '${me}'`}
${D?`AND teams.team_id IN (${Ae.join(",")})`:""}
${t?"AND ((matches.barracks_status_radiant = 0 AND matches.radiant_win) OR (matches.barracks_status_dire = 0 AND NOT matches.radiant_win))":""}
${n?`AND @ matches.radiant_gold_adv[array_upper(matches.radiant_gold_adv, 1)] <= ${n.value}`:""}
${e?`AND @ matches.radiant_gold_adv[array_upper(matches.radiant_gold_adv, 1)] >= ${e.value}`:""}
GROUP BY hero_id
ORDER BY total ${ae&&ae.value||"DESC"}`;else{const d={},R={};z(l)&&l.forEach(o=>{R[o.key]=`${o.value}${o.bucket?` / ${o.bucket} * ${o.bucket}`:""}`}),z(c)&&c.forEach(o=>{d[o.key]=o.groupValue||o&&o.value||1}),u=`SELECT
    ${z(c)?c.map(o=>o.distinct&&!z(l)?`DISTINCT ON (${o.value})`:"").join(""):""}    ${z(l)?l.map(o=>[`${o.groupKeySelect||R[o.key]} ${o.alias||""},`].filter(Boolean).join(`,
`)).join(""):""}
${z(l)&&z(c)&&c.map(o=>[o&&o.countValue||"",o&&o.avgPerMatch?`sum(${d[o.key]})::numeric/count(distinct matches.match_id) "AVG ${o.text}"`:`${o&&o.avg?o.avg:`avg(${d[o.key]})`} "AVG ${o.text}"`,"count(distinct matches.match_id) count","sum(case when (player_matches.player_slot < 128) = radiant_win then 1 else 0 end)::float/count(1) winrate",`((sum(case when (player_matches.player_slot < 128) = radiant_win then 1 else 0 end)::float/count(1)) 
+ 1.96 * 1.96 / (2 * count(1)) 
- 1.96 * sqrt((((sum(case when (player_matches.player_slot < 128) = radiant_win then 1 else 0 end)::float/count(1)) * (1 - (sum(case when (player_matches.player_slot < 128) = radiant_win then 1 else 0 end)::float/count(1))) + 1.96 * 1.96 / (4 * count(1))) / count(1))))
/ (1 + 1.96 * 1.96 / count(1)) winrate_wilson`,`sum(${d[o.key]}) sum`,`min(${d[o.key]}) min`,`max(${d[o.key]}) max`,`stddev(${d[o.key]}::numeric) stddev
  `].filter(Boolean).join(`,
`))||""}
${z(l)?"":[z(c)?c.map(o=>`${o.value} ${o.alias||""}`):"","matches.match_id","matches.start_time","((player_matches.player_slot < 128) = matches.radiant_win) win","player_matches.hero_id","player_matches.account_id","leagues.name leaguename"].filter(Boolean).join(`,
`)}
FROM matches
JOIN match_patch using(match_id)
JOIN leagues using(leagueid)
JOIN player_matches using(match_id)
JOIN heroes on heroes.id = player_matches.hero_id
LEFT JOIN notable_players ON notable_players.account_id = player_matches.account_id
LEFT JOIN teams using(team_id)
${re||l!==null&&l.length>0&&l[0]&&l.some(o=>o.key==="organization")?"JOIN team_match ON matches.match_id = team_match.match_id AND (player_matches.player_slot < 128) = team_match.radiant JOIN teams teams2 ON team_match.team_id = teams2.team_id":""}
${z(c)?c.map(o=>o.joinFn?o.joinFn(v):"").join(""):""}
${z(c)?c.map(o=>o.join?o.join:"").join(""):""}
WHERE TRUE
${z(c)?c.map(o=>`AND ${o.value} IS NOT NULL `).join(""):""}
${O`match_patch.patch >= '${a}'`}
${O`match_patch.patch <= '${h}'`}
${O`player_matches.hero_id = ${A}`}
${O`player_matches.account_id = ${g}`}
${O`matches.leagueid = ${I}`}
${O`(player_matches.purchase->>'${s}')::int > 0`}
${O`matches.duration >= ${y}`}
${O`matches.duration <= ${C}`}
${O`(player_matches.player_slot < 128) = ${Q}`}
${O`((player_matches.player_slot < 128) = matches.radiant_win) = ${r}`}
${O`notable_players.team_id = ${b}`}
${O`team_match.team_id = ${re} AND (player_matches.player_slot < 128) = team_match.radiant`}
${O`player_matches.lane_role = ${ke}`}
${O`matches.cluster IN (${se})`}
${ne?O`matches.start_time >= extract(epoch from timestamp '${new Date(ne.value).toISOString()}')`:""}
${he?O`matches.start_time <= extract(epoch from timestamp '${new Date(he.value).toISOString()}')`:""}
${O`leagues.tier = '${me}'`}
${D?`AND teams.team_id IN (${Ae.join(",")})`:""}
${t?"AND ((matches.barracks_status_radiant = 0 AND matches.radiant_win) OR (matches.barracks_status_dire = 0 AND NOT matches.radiant_win))":""}
${n?`AND @ matches.radiant_gold_adv[array_upper(matches.radiant_gold_adv, 1)] <= ${n.value}`:""}
${e?`AND @ matches.radiant_gold_adv[array_upper(matches.radiant_gold_adv, 1)] >= ${e.value}`:""}
${z(l)?"GROUP BY":""}${z(l)&&l.map(o=>` ${R[o.key]}`)||""}
${z(l)?`HAVING count(distinct matches.match_id) >= ${pe&&pe.value||"1"}`:""}
ORDER BY ${[`${z(l)&&z(c)&&c.map(o=>`"AVG ${o.text}" ${ae?ae.value:"DESC"}`)||z(c)&&c.map(o=>`${o.value} ${ae?ae.value:"DESC"}`).join(",")||"matches.match_id DESC"}`,z(l)?"count DESC":""].filter(Boolean).join(",")} NULLS LAST
LIMIT ${Z?Z.value:200}`}return u.replace(/\n{2,}/g,`
`)},be=({defaultSelected:v,label:i,format:f,href:a,download:h,onClick:A,context:g})=>{let I;return A?I=A:f?I=()=>{g.setState({...g.state,builder:{...g.state.builder,format:f}},g.syncWindowHistory)}:I=s=>s,m.createElement(Oe,{secondary:f&&(v&&!g.state.builder.format||g.state.builder.format===f),style:{margin:"5px"},label:i,href:a,download:h,onClick:I})};be.propTypes={defaultSelected:T.string,label:T.string,format:T.string,href:T.string,download:T.string,onClick:T.func,context:T.shape({})};const rt=Be.div`
  padding: 0 15px;
  box-sizing: border-box;
  display: ${v=>v.showEditor?"none":"flex"};
  flex-direction: row;
  flex-wrap: wrap;
`,Ue=({showToggle:v,showEditor:i,toggleEditor:f,children:a,strings:h})=>m.createElement("div",null,m.createElement("div",{style:{width:"180px",margin:"10px"}},m.createElement("div",null),v&&m.createElement(Ve,{label:h.explorer_toggle_sql,defaultToggled:i,onToggle:f})),m.createElement(rt,{showEditor:i},a),m.createElement("div",{style:{display:i?"block":"none"}},m.createElement("div",{id:"editor",style:{height:100,width:"100%"}})));Ue.propTypes={showToggle:T.bool,showEditor:T.bool,toggleEditor:T.func,children:T.arrayOf(T.node),strings:T.shape({})};const st=v=>({strings:v.app.strings}),nt=Le(st)(Ue);class F extends m.Component{static propTypes={fields:T.arrayOf({}),label:T.string,builderField:T.func,handleFieldUpdate:T.func,isDateField:T.bool,builder:T.func,chipLimit:T.number,multipleSelect:T.bool};constructor(){super(),this.state={},ue(()=>import("./index-78f7331a.js").then(i=>i.i),[]).then(i=>this.setState({DatePicker:i.default}))}componentDidUpdate(i){if(this.autocomplete&&this.autocomplete.state){const{builderField:f,builder:a,fields:h}=i,A=h&&h[f],g=a[f]?(A.find(I=>I.key===a[f])||{}).text:"";g&&this.autocomplete.setState({searchText:g})}}addChip=(i,f,a)=>{const h=[].concat(this.props.builder[i]||[]),A=h.includes(f.key)?h:[f.key].concat(h).slice(0,a);this.props.handleFieldUpdate(i,A)};deleteChip=(i,f)=>{const a=[].concat(this.props.builder[i]||[]),h=[...a.slice(0,f),...a.slice(f+1)];this.props.handleFieldUpdate(i,h)};resetField=()=>{const{builderField:i,handleFieldUpdate:f}=this.props;this.autocomplete&&this.autocomplete.setState({searchText:""}),this.datepicker&&this.datepicker.setState({date:void 0}),f(i,void 0)};render(){const{DatePicker:i}=this.state,{fields:f,label:a,builderField:h,handleFieldUpdate:A,isDateField:g,builder:I,chipLimit:s,multipleSelect:y}=this.props,C=f&&f[h],Q=280;return g?m.createElement("span",{style:{width:Q}},i&&m.createElement(i,{ref:r=>(this.datepicker=r,null),floatingLabelText:a,container:"inline",autoOk:!0,defaultDate:I[h]?new Date(I[h]):void 0,onShow:this.resetField,onChange:(r,b)=>{A(h,b.toISOString())}})):m.createElement("span",{style:{width:Q}},y?m.createElement(Je,{name:h,label:a,dataSource:C,formSelectionState:I,filter:xe.caseInsensitiveFilter,strict:!0,limit:s,addChip:this.addChip,deleteChip:this.deleteChip,resetField:this.resetField}):m.createElement(xe,{ref:r=>(this.autocomplete=r,null),openOnFocus:!0,listStyle:{maxHeight:400,overflow:"auto"},fullWidth:!0,filter:xe.caseInsensitiveFilter,floatingLabelText:a,dataSource:C,maxSearchResults:100,onClick:this.resetField,onNewRequest:(r,b)=>{A(h,b>-1?r.key:"")}}))}}const Ce={111:1,112:1,113:1,114:1,117:1,118:1,121:2,122:2,123:2,124:2,131:3,132:3,133:3,134:3,135:3,136:3,137:3,138:3,141:19,142:19,143:19,144:19,145:19,151:5,152:5,153:5,154:5,155:5,156:5,161:6,162:6,163:6,171:7,172:7,181:8,182:8,183:8,184:8,185:8,186:8,187:8,188:8,191:9,192:9,193:9,200:10,201:10,202:10,203:10,204:10,211:11,212:11,213:11,214:11,221:12,222:12,223:18,224:12,225:17,227:20,231:13,232:25,235:13,236:13,241:14,242:14,251:15,261:16,271:3,272:3,273:3,274:3,346:38,347:38},ye=(await ue(()=>import("./items-2a682a8b.js"),[])).default,lt=v=>["_2","_3","_4","_5"].some(i=>v.indexOf(i)!==-1)?v[v.length-1]:"",Fe=(v=[],i=[],f=[])=>{const{strings:a}=Pe.getState().app,h={value:"key",groupValue:"value::text::int",groupKey:"key",avgPerMatch:!0,bundle:"json_select",singleSelection:"true"},A=r=>({text:`${a.explorer_uses} - ${ye[r].dname} ${lt(r)}`,value:`(item_uses->>'${r}')::int`,key:`uses_${r}`,alias:"uses",bundle:"uses"}),g=[{text:a.heading_kills,value:"kills",key:"kills"},{text:a.heading_deaths,value:"deaths",key:"deaths"},{text:a.heading_assists,value:"assists",key:"assists"},{text:a.heading_gold_per_min,value:"gold_per_min",bucket:50,key:"gold_per_min"},{text:a.heading_xp_per_min,value:"xp_per_min",bucket:50,key:"xp_per_min"},{text:a.heading_last_hits,value:"last_hits",bucket:10,key:"last_hits"},{text:a.heading_denies,value:"denies",key:"denies"},{text:a.heading_hero_damage,value:"hero_damage",bucket:1e3,key:"hero_damage"},{text:a.heading_tower_damage,value:"tower_damage",bucket:1e3,key:"tower_damage"},{text:a.heading_hero_healing,value:"hero_healing",bucket:1e3,key:"hero_healing"},{text:a.heading_level,value:"level",key:"level"},{text:a.heading_stuns,value:"stuns",bucket:1,key:"stuns"},{text:a.heading_camps_stacked,value:"camps_stacked",key:"camps_stacked"},{text:a.heading_lhten,value:"lh_t[11]",bucket:10,key:"lh10"},{text:a.heading_lhtwenty,value:"lh_t[21]",bucket:10,key:"lh20"},{text:a.heading_lhthirty,value:"lh_t[31]",bucket:10,key:"lh30"},{text:a.heading_lhforty,value:"lh_t[41]",bucket:10,key:"lh40"},{text:a.heading_lhfifty,value:"lh_t[51]",bucket:10,key:"lh50"},{text:a.th_buybacks,value:"array_length(buyback_log, 1)",key:"buybacks"},{text:a.th_scans_used,value:"(actions->>'31')::int",key:"scans_used"},{text:a.th_glyphs_used,value:"(actions->>'24')::int",key:"glyphs_used"},{text:a.th_obs_placed,value:"array_length(obs_log, 1)",key:"obs_placed"},{text:a.th_sen_placed,value:"array_length(sen_log, 1)",key:"sen_placed"},{text:a.th_obs_destroyed,value:"(killed->>'npc_dota_observer_wards')::int",key:"obs_destroyed"},{text:a.th_sen_destroyed,value:"(killed->>'npc_dota_sentry_wards')::int",key:"sen_destroyed"},{text:a.th_legs,value:"heroes.legs",key:"legs"},{text:a.th_fantasy_points,value:"round((0.3 * kills + (3 - 0.3 * deaths) + 0.003 * (last_hits + denies) + 0.002 * gold_per_min + towers_killed + roshans_killed + 3 * teamfight_participation + 0.5 * observers_placed + 0.5 * camps_stacked + 0.25 * rune_pickups + 4 * firstblood_claimed + 0.05 * stuns)::numeric, 1)",key:"fantasy_points",bucket:1},{text:a.heading_damage_dealt,value:"(SELECT SUM(value::text::int) FROM json_each(damage_inflictor))",key:"dmg_dealt"},{text:a.heading_damage_received,value:"(SELECT SUM(value::text::int) FROM json_each(damage_inflictor_received))",key:"dmg_received"}].map(r=>({...r,alias:r.alias||r.key,bundle:"single"})),I=We.reverse().map(r=>({text:r.name,value:r.name,key:r.name})),s=Array(10).fill().map((r,b)=>b*10).map(r=>({text:`${Te(a.time_mm,r)}`,searchText:Te(a.time_mm,r),value:r*60,key:String(r)})),y=Array(5).fill().map((r,b)=>(b+1)*5).map(r=>({text:String(r),value:r,key:String(r)})),C=[100,200,500,1e3].map(r=>({text:String(r),value:r,key:String(r)})),Q=Array(31).fill().map((r,b)=>b*1e3).map(r=>({text:String(r),value:r,key:String(r)}));return{select:[{text:a.heading_duration,value:"duration",alias:"as time",key:"duration",formatSeconds:!0,bundle:"duration"},{text:a.heading_distinct_heroes,value:"player_matches.hero_id",countValue:"count(distinct player_matches.hero_id) distinct_heroes",key:"distinct_heroes",distinct:!0,bundle:"distinct_heroes"},{...h,text:a.heading_item_purchased,alias:"item_name",join:", json_each(player_matches.purchase)",key:"item_purchased"},{...h,text:a.heading_ability_used,alias:"ability_name",join:", json_each(player_matches.ability_uses)",key:"ability_used"},{...h,text:a.heading_item_used,alias:"item_name",join:", json_each(player_matches.item_uses)",key:"item_used"},{...h,text:a.heading_damage_inflictor,alias:"inflictor",join:", json_each(player_matches.damage_inflictor)",key:"damage_inflictor"},{...h,text:a.heading_damage_inflictor_received,alias:"inflictor",join:", json_each(player_matches.damage_inflictor_received)",key:"damage_inflictor_received"},{...h,text:a.heading_runes,alias:"rune_id",join:", json_each(player_matches.runes)",key:"runes"},{...h,text:a.heading_unit_kills,join:", json_each(player_matches.killed)",key:"unit_kills"},{...h,text:a.heading_damage_instances,join:", json_each(player_matches.hero_hits)",key:"damage_instances"},{text:a.explorer_hero_combos,value:1,groupValue:1,groupKeySelect:"player_matches.hero_id, player_matches2.hero_id hero_id2",groupKey:"player_matches.hero_id, player_matches2.hero_id",joinFn:r=>`JOIN player_matches player_matches2
ON player_matches.match_id = player_matches2.match_id
AND player_matches.hero_id != player_matches2.hero_id 
AND abs(player_matches.player_slot - player_matches2.player_slot) < 10
${r.hero&&r.hero.value?"":"AND player_matches.hero_id < player_matches2.hero_id"}`,key:"hero_combos",bundle:"combinations"},{text:a.explorer_hero_player,value:1,groupValue:1,groupKey:"player_matches.hero_id, player_matches.account_id",key:"hero_player",bundle:"combinations"},{text:a.explorer_player_player,value:1,groupValue:1,groupKeySelect:"player_matches.account_id, player_matches2.account_id account_id2",groupKey:"player_matches.account_id, player_matches2.account_id",joinFn:r=>`JOIN player_matches player_matches2
ON player_matches.match_id = player_matches2.match_id
AND player_matches.account_id != player_matches2.account_id 
AND abs(player_matches.player_slot - player_matches2.player_slot) < 10
${r.player&&r.player.value?"":"AND player_matches.account_id < player_matches2.account_id"}`,key:"player_player",bundle:"combinations"},{text:a.explorer_picks_bans,template:"picks_bans",key:"picks_bans",where:"AND team_match.radiant::int != picks_bans.team",value:1,bundle:"picks_bans"},{text:a.explorer_counter_picks_bans,template:"picks_bans",key:"counter_picks_bans",where:"AND team_match.radiant::int = picks_bans.team",value:1,bundle:"picks_bans"}].concat(Object.keys(ye).filter(r=>ye[r].cd).map(A)).concat(g).sort((r,b)=>r.text&&r.text.localeCompare(b.text)),group:[{text:a.explorer_player,value:"notable_players.name",key:"player"},{text:a.th_hero_id,value:"heroes.localized_name",key:"hero"},{text:a.explorer_league,value:"leagues.name",alias:"leaguename",key:"league"},{text:a.explorer_patch,value:"patch",key:"patch"},{text:a.heading_duration,value:"duration/300*5",alias:"minutes",key:"duration"},{text:a.explorer_side,value:"(player_matches.player_slot < 128)",alias:"is_radiant",key:"side"},{text:a.th_result,value:"((player_matches.player_slot < 128) = matches.radiant_win)",alias:"win",key:"result"},{text:a.explorer_team,value:"teams.name",key:"team"},{text:a.explorer_organization,value:"teams2.name",key:"organization"},{text:a.explorer_match,value:"matches.match_id",key:"match"}].concat(g),minPatch:I,maxPatch:I,hero:Object.keys(de).map(r=>({text:`[${r}] ${de[r].localized_name}`,searchText:de[r].localized_name,value:de[r].id,key:String(de[r].id)})),playerPurchased:Object.keys(ye).map(r=>({text:ye[r].dname,value:r,key:r})),minDuration:s,maxDuration:s,side:[{text:a.general_radiant,value:!0,key:"radiant"},{text:a.general_dire,value:!1,key:"dire"}],result:[{text:a.td_win,value:!0,key:"win"},{text:a.td_loss,value:!1,key:"loss"}],region:Object.keys(He).map(r=>({text:a[`region_${r}`],value:Object.keys(Ce).filter(b=>String(Ce[b])===r),key:String(r)})),league:i.map(r=>({text:`[${r.leagueid}] ${r.name}`,searchText:r.name,value:r.leagueid,key:String(r.leagueid)})),team:f.map(r=>({text:`[${r.team_id}] ${r.name}`,searchText:r.name,value:r.team_id,key:String(r.team_id)})),organization:f.map(r=>({text:`[${r.team_id}] ${r.name}`,searchText:r.name,value:r.team_id,key:String(r.team_id)})),player:v.map(r=>({text:`[${r.account_id}] ${r.name}`,searchText:r.name,value:r.account_id,key:String(r.account_id)})),tier:["premium","professional"].map(r=>({text:a[`tier_${r}`],value:r,key:r})),order:[{text:a.explorer_asc,value:"ASC",key:"asc"},{text:a.explorer_desc,value:"DESC",key:"desc"}],having:y,limit:C,laneRole:Object.keys(a).filter(r=>r.indexOf("lane_role_")===0).map(r=>{const b=Number(r.substring(10));return{text:a[r],value:b,key:String(b)}}),isTiTeam:[{text:"Yes",value:!0,key:"true"}],megaWin:[{text:"Yes",value:!0,key:"true"}],minGoldAdvantage:Q,maxGoldAdvantage:Q}},Ie=(await ue(()=>import("./items-2a682a8b.js"),[])).default,ot=["SELECT","WHERE","GROUP BY","ORDER BY"],ct=["FROM","JOIN","LEFT JOIN"],dt=["matches","player_matches","teams","match_logs","public_matches","public_player_matches"],ut=["OFFSET","LIMIT","DISTINCT","IN"],ht=["to_timestamp()","count()","avg()","sum()","stddev()","min()","max()","using()"],pt=(v,i=[],f=[],a=[])=>{const{strings:h}=Pe.getState().app,A=i.filter(s=>s.name).slice(0).map(s=>({value:s.name,snippet:s.account_id.toString(),meta:`${s.account_id.toString()} (${h.explorer_player})`})),g=f.filter(s=>s.name).slice(0,100).map(s=>({value:s.name,snippet:s.team_id.toString(),meta:`${s.team_id.toString()} (${h.explorer_organization})`})),I=a.filter(s=>s.tier==="premium"||s.tier==="professional").map(s=>({value:s.name,snippet:s.leagueid.toString(),meta:`${s.leagueid.toString()} (${h.explorer_league})`}));return{getCompletions(s,y,C,Q,r){r(null,[].concat(Object.keys(de).map(b=>({caption:de[b].localized_name,value:de[b].name,snippet:b,meta:`${b} (${h.explorer_hero})`}))).concat(Object.keys(Ie).filter(b=>b.indexOf("recipe_")!==0).map(b=>({caption:Ie[b].dname,value:b,snippet:`'${b}'`,meta:`${b} (${h.scenarios_item})`}))).concat(A).concat(g).concat(I).concat(ht.map(b=>({value:b,meta:h.explorer_postgresql_function}))).concat(ot.map(b=>({value:b,meta:h.explorer_sql}))).concat(ct.map(b=>({value:b,meta:h.explorer_sql}))).concat(ut.map(b=>({value:b,meta:h.explorer_sql}))).concat(dt.map(b=>({value:b,meta:h.explorer_table}))).concat(v.map(b=>({value:`${b.column_name}`,meta:`${b.table_name} - ${b.data_type}`}))))}}},$e={},we={};function Ne(v){return v.json()}function je(v,i){const f={};return Object.keys(v).forEach(a=>{Array.isArray(v[a])?f[a]=v[a].map(h=>(i[a]||[]).find(A=>A.key===h)||{value:h}):v[a]&&(f[a]=(i[a]||[]).find(h=>h.key===v[a])||{value:v[a]})}),f}class _t extends m.Component{static propTypes={proPlayers:T.arrayOf({}),teams:T.arrayOf({}),leagues:T.shape({}),dispatchProPlayers:T.func,dispatchLeagues:T.func,dispatchTeams:T.func,strings:T.shape({})};constructor(){super();let i={},f="";try{i=Ee.parse(window.location.search.substring(1)),f=i.sql,delete i.sql}catch{}this.state={loadingEditor:!0,showEditor:!!f,loading:!1,result:{},builder:i}}async componentDidMount(){this.props.dispatchProPlayers(),this.props.dispatchLeagues(),this.props.dispatchTeams(),await ue(()=>import("./ace-a2760ce2.js").then(i=>i.a),["assets/ace-a2760ce2.js","assets/index-78f7331a.js"]),await Promise.all([ue(()=>import("./ext-language_tools-7a2f4c71.js").then(i=>i.e),["assets/ext-language_tools-7a2f4c71.js","assets/index-78f7331a.js"]),ue(()=>import("./theme-monokai-89c4b50b.js").then(i=>i.t),["assets/theme-monokai-89c4b50b.js","assets/index-78f7331a.js"]),ue(()=>import("./mode-sql-53d1a7e2.js").then(i=>i.m),["assets/mode-sql-53d1a7e2.js","assets/index-78f7331a.js"])]),this.instantiateEditor()}componentDidUpdate(i){this.editor&&!this.completersSet&&i.proPlayers.length&&i.teams.length&&i.leagues.length&&(this.completersSet=!0,fetch(`${Se.VITE_API_HOST}/api/schema`).then(Ne).then(f=>{this.editor.completers=[pt(f,i.proPlayers,i.teams,i.leagues)]}))}getSqlString=()=>this.editor.getSelectedText()||this.editor.getValue();buildQuery=()=>{const i=je(this.state.builder,Fe());this.editor.setValue(it(i))};handleCancel=()=>{this.setState({loading:!1}),window.stop()};handleFieldUpdate=(i,f)=>{this.setState({builder:{...this.state.builder,[i]:f}},this.buildQuery)};sendRequest=()=>{this.syncWindowHistory();const i=this.getSqlString();return fetch(`${Se.VITE_API_HOST}/api/explorer?sql=${encodeURIComponent(i)}`).then(Ne).then(this.handleResponse)};handleQuery=()=>{const{builder:i,showEditor:f}=this.state,{select:a,group:h}=i;this.state.loadingEditor===!0?setTimeout(this.handleQuery,1e3):h&&(!a||a.length<1)&&!f?this.setState({builder:{...i,select:"kills"}},()=>{this.buildQuery(),this.handleQuery()}):this.setState({loading:!0},this.sendRequest)};handleResponse=i=>{this.setState({loading:!1,result:i})};instantiateEditor=()=>{const i=ace.edit("editor");i.setTheme("ace/theme/monokai"),i.getSession().setMode("ace/mode/sql"),i.setOptions({minLines:10,maxLines:1/0,enableLiveAutocompletion:!0,showPrintMargin:!1}),this.editor=i;const{sql:f}=Ee.parse(window.location.search.substring(1));f?i.setValue(decodeURIComponent(f)):this.buildQuery(),this.handleQuery(),this.setState({...this.state,loadingEditor:!1})};syncWindowHistory=()=>{const i=this.getSqlString(),f=this.state.showEditor?{sql:i,format:this.state.builder.format}:this.state.builder,a=`?${Ee.stringify(f)}`;window.history.pushState("","",a)};toggleEditor=()=>{this.setState({...this.state,showEditor:!this.state.showEditor}),this.editor.renderer.updateFull()};render(){Object.keys($e).length||this.props.proPlayers.forEach(C=>{$e[C.account_id]=C.name}),Object.keys(we).length||this.props.teams.forEach(C=>{we[C.team_id]=C.name});const i=Fe(this.props.proPlayers,this.props.leagues,this.props.teams),f=je(this.state.builder,i),{handleQuery:a,handleCancel:h,getSqlString:A,handleFieldUpdate:g}=this,I=this,{builder:s}=this.state,{strings:y}=this.props;return m.createElement("div",null,m.createElement(Ge,{title:`${y.title_explorer} - ${y.explorer_subtitle}`}),m.createElement(Re,{title:y.explorer_title,subtitle:y.explorer_description,className:"top-heading"}),m.createElement(nt,{showToggle:!0,showEditor:this.state.showEditor,toggleEditor:this.toggleEditor},m.createElement(F,{label:y.explorer_select,fields:i,builderField:"select",handleFieldUpdate:g,builder:s,multipleSelect:!0}),m.createElement(F,{label:y.explorer_group_by,fields:i,builderField:"group",handleFieldUpdate:g,builder:s}),m.createElement(F,{label:y.explorer_hero,fields:i,builderField:"hero",handleFieldUpdate:g,builder:s,multipleSelect:!0}),m.createElement(F,{label:y.explorer_player,fields:i,builderField:"player",handleFieldUpdate:g,builder:s,multipleSelect:!0}),m.createElement(F,{label:y.explorer_team,fields:i,builderField:"team",handleFieldUpdate:g,builder:s,multipleSelect:!0}),m.createElement(F,{label:y.explorer_organization,fields:i,builderField:"organization",handleFieldUpdate:g,builder:s,multipleSelect:!0}),m.createElement(F,{label:y.explorer_league,fields:i,builderField:"league",handleFieldUpdate:g,builder:s,multipleSelect:!0}),m.createElement(F,{label:y.explorer_tier,fields:i,builderField:"tier",handleFieldUpdate:g,builder:s}),m.createElement(F,{label:y.explorer_region,fields:i,builderField:"region",handleFieldUpdate:g,builder:s,multipleSelect:!0}),m.createElement(F,{label:y.explorer_side,fields:i,builderField:"side",handleFieldUpdate:g,builder:s}),m.createElement(F,{label:y.th_result,fields:i,builderField:"result",handleFieldUpdate:g,builder:s}),m.createElement(F,{label:y.explorer_player_purchased,fields:i,builderField:"playerPurchased",handleFieldUpdate:g,builder:s,multipleSelect:!0}),m.createElement(F,{label:y.explorer_lane_role,fields:i,builderField:"laneRole",handleFieldUpdate:g,builder:s,multipleSelect:!0}),m.createElement(F,{label:y.explorer_min_patch,fields:i,builderField:"minPatch",handleFieldUpdate:g,builder:s}),m.createElement(F,{label:y.explorer_max_patch,fields:i,builderField:"maxPatch",handleFieldUpdate:g,builder:s}),m.createElement(F,{label:y.explorer_min_duration,fields:i,builderField:"minDuration",handleFieldUpdate:g,builder:s}),m.createElement(F,{label:y.explorer_max_duration,fields:i,builderField:"maxDuration",handleFieldUpdate:g,builder:s}),m.createElement(F,{label:y.explorer_min_date,builderField:"minDate",handleFieldUpdate:g,builder:s,isDateField:!0,minDate:!0}),m.createElement(F,{label:y.explorer_max_date,builderField:"maxDate",handleFieldUpdate:g,builder:s,isDateField:!0}),m.createElement(F,{label:y.explorer_order,fields:i,builderField:"order",handleFieldUpdate:g,builder:s}),m.createElement(F,{label:y.explorer_having,fields:i,builderField:"having",handleFieldUpdate:g,builder:s}),m.createElement(F,{label:y.explorer_limit,fields:i,builderField:"limit",handleFieldUpdate:g,builder:s}),m.createElement(F,{label:y.explorer_is_ti_team,fields:i,builderField:"isTiTeam",handleFieldUpdate:g,builder:s}),m.createElement(F,{label:y.explorer_mega_comeback,fields:i,builderField:"megaWin",handleFieldUpdate:g,builder:s}),m.createElement(F,{label:y.explorer_max_gold_adv,fields:i,builderField:"maxGoldAdvantage",handleFieldUpdate:g,builder:s}),m.createElement(F,{label:y.explorer_min_gold_adv,fields:i,builderField:"minGoldAdvantage",handleFieldUpdate:g,builder:s})),m.createElement("div",null,m.createElement(Oe,{primary:!this.state.loading,secondary:this.state.loading,style:{margin:"5px"},icon:this.state.loading?null:m.createElement(Qe,null),label:this.state.loading?y.explorer_cancel_button:y.explorer_query_button,onClick:this.state.loading?h:a}),m.createElement(Oe,{secondary:!0,target:"_blank",style:{margin:"5px"},label:y.explorer_schema,href:"https://github.com/odota/core/blob/master/sql/create_tables.sql"}),m.createElement("span",{style:{float:"right"}},m.createElement(be,{defaultSelected:!0,label:y.explorer_table_button,format:"table",context:I}),m.createElement(be,{label:y.explorer_csv_button,href:`data:application/octet-stream,${encodeURIComponent(at.unparse({data:this.state.result.rows||[],fields:(this.state.result.fields||[]).map(C=>C.name)}))}`,download:"data.csv",context:I}),m.createElement(be,{label:y.explorer_json_button,href:`data:application/octet-stream,${encodeURIComponent(JSON.stringify(this.state.result.rows,null,2))}`,download:"data.json",context:I}),m.createElement(be,{label:y.explorer_api_button,onClick:()=>window.open(`${Se.VITE_API_HOST}/api/explorer?sql=${encodeURIComponent(A())}`,"_blank"),context:I}))),m.createElement(Re,{title:y.explorer_results,subtitle:`${(this.state.result.rows||[]).length} ${y.explorer_num_rows}`}),m.createElement("pre",{style:{color:"red"}},this.state.result.err),this.state.loading?m.createElement(Ke,null):null,!this.state.loading&&m.createElement(Ye,{rows:this.state.result.rows,fields:this.state.result.fields,expandedBuilder:f,playerMapping:$e,teamMapping:we,format:this.state.builder.format}))}}const mt=v=>({proPlayers:v.app.proPlayers.data,leagues:v.app.leagues.data,teams:v.app.teams.data,strings:v.app.strings}),ft=v=>({dispatchProPlayers:()=>v(Ze()),dispatchLeagues:()=>v(Xe()),dispatchTeams:()=>v(et())}),yt=Le(mt,ft)(_t);export{yt as default};
